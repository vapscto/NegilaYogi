<section class="content">
    <form class="form-horizontal ng-pristine ng-valid" name="myForm" role="form" novalidate>
        <div data-ng-init="BindData()">
            <div class="box box-primary">
                <div class="box-header with-border">
                    <h3 class="box-title">Cumulative Report</h3>
                    <div class="box-tools pull-right">
                        <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                    </div>
                </div>
                <div class="box-body">
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label class="control-label col-sm-4">Academic Year:<span style="color:Red">*</span></label>
                                    <div class="col-sm-8">
                                        <select class="form-control" id="sel11" name="coursed" ng-model="ASMAY_Id" ng-change="onchangeyear()" required>
                                            <option value="">--Select--</option>
                                            <option ng-repeat="clas in yearlist" value="{{clas.asmaY_Id}}" ng-selected="{{clas.Selected==true}}">
                                                {{clas.asmaY_Year}}
                                            </option>
                                        </select>
                                        <div class="error-messages" ng-if="interacted(myForm.coursed)" ng-messages="myForm.coursed.$error">
                                            <div ng-message="required">Please Select Year</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="control-label col-sm-4">Course:<span style="color:Red">*</span></label>
                                    <div class="col-sm-8">
                                        <select class="form-control" id="sel1" name="course" ng-model="AMCO_Id" ng-change="onchangecourse()" required>
                                            <option value="">--Select--</option>
                                            <option ng-repeat="clas in course_list" value="{{clas.amcO_Id}}" ng-selected="{{clas.Selected==true}}">
                                                {{clas.amcO_CourseName}}
                                            </option>
                                        </select>
                                        <div class="error-messages" ng-if="interacted(myForm.course)" ng-messages="myForm.course.$error">
                                            <div ng-message="required">Please Select Course</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="control-label col-sm-4">Branch:<span style="color:Red">*</span></label>
                                    <div class="col-sm-8">
                                        <select class="form-control" id="sel1" name="branc" ng-model="AMB_Id" ng-change="onchangebranch()" required>
                                            <option value="">--Select--</option>
                                            <option ng-repeat="bran in branch_list" value="{{bran.amB_Id}}" ng-selected="{{bran.Selected==true}}">
                                                {{bran.amB_BranchName}}
                                            </option>
                                        </select>
                                        <div class="error-messages" ng-if="interacted(myForm.branc)" ng-messages="myForm.branc.$error">
                                            <div ng-message="required">Please Select Branch</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="sel2" class="control-label col-sm-4">Semester:<span style="color:Red">*</span></label>
                                    <div class="col-sm-8">
                                        <select class="form-control" id="sel12vv" name="semis" ng-model="AMSE_Id" ng-change="onchangesemester()" required>
                                            <option value="">--Select--</option>
                                            <option ng-repeat="semi in semisters_list" value="{{semi.amsE_Id}}" ng-selected="{{semis.Selected==true}}">
                                                {{semi.amsE_SEMName}}
                                            </option>
                                        </select>
                                        <div class="error-messages" ng-if="interacted(myForm.semis)" ng-messages="myForm.semis.$error">
                                            <div ng-message="required">Select Semester</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="control-label col-sm-4">Section :<span style="color:Red">*</span></label>
                                    <div class="col-sm-8">
                                        <select class="form-control" id="sm" name="secdd" ng-model="ACMS_Id" required>
                                            <option value="">Select</option>
                                            <option ng-repeat="sec in seclist" value="{{sec.acmS_Id}}" ng-selected="{{sec.Selected == true}}">{{sec.acmS_SectionName}}</option>
                                        </select>
                                        <div class="error-messages" ng-if="interacted(myForm.secdd)" ng-messages="myForm.secdd.$error">
                                            <div ng-message="required">Please Select Section</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="control-label col-sm-4">Subject Scheme:<span style="color:Red">*</span></label>
                                    <div class="col-sm-8">
                                        <select class="form-control" id="sel12" name="sschemas" ng-model="ACSS_Id" ng-change="onchangesubjectscheme()" required>
                                            <option value="">--Select--</option>
                                            <option ng-repeat="sschema in subjectschema_list" value="{{sschema.acsS_Id}}" ng-selected="{{sschema.Selected==true}}">
                                                {{sschema.acsS_SchmeName}}
                                            </option>
                                        </select>
                                        <div class="error-messages" ng-if="interacted(myForm.sschemas)" ng-messages="myForm.sschemas.$error">
                                            <div ng-message="required">Please Select Subject Scheme</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="control-label col-sm-4">Scheme Type:<span style="color:Red">*</span></label>
                                    <div class="col-sm-8">
                                        <select class="form-control" id="sel165" name="schematype" ng-change="onchangeschemetype()" ng-model="ACST_Id" required>
                                            <option value="">--Select--</option>
                                            <option ng-repeat="scmatype in schmetype_list" value="{{scmatype.acsT_Id}}" ng-selected="{{scmatype.Selected==true}}">
                                                {{scmatype.acsT_SchmeType}}
                                            </option>
                                        </select>
                                        <div class="error-messages" ng-if="interacted(myForm.schematype)" ng-messages="myForm.schematype.$error">
                                            <div ng-message="required">Please Select Scheme Type</div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label for="sel2" class="control-label col-sm-4">Exam: <span style="color:Red">*</span></label>
                                    <div class="col-sm-8 multiselect">
                                        <label ng-repeat="option9 in exam_list" data-ng-model="EME_Id" value="{{option9.emE_Id}}">
                                            <input name="asd" ng-model="option9.EME_Id" type="checkbox" ng-required="isOptionsRequired()">
                                            <span class="lbl padding-8">
                                                {{option9.emE_ExamName}}
                                            </span>
                                        </label>
                                        <div class="error-messages" ng-if="interacted(myForm.asd)" ng-messages="myForm.asd.$error">
                                            <div ng-message="required">Select Exam</div>
                                        </div>
                                    </div>

                                </div>

                                <div class="form-group">
                                    <label for="sel2" class="control-label col-sm-4">Subject : <span style="color:Red">*</span></label>
                                    <div class="col-sm-8">
                                        <select class="form-control" id="sel12vvdd" name="examoption" ng-model="ISMS_Id" required>
                                            <option value="">--Select--</option>
                                            <option ng-repeat="sub in subjectlist" value="{{sub.ismS_Id}}" ng-selected="{{sub.Selected==true}}">
                                                {{sub.ismS_SubjectName}} : {{sub.ismS_SubjectCode}}
                                            </option>
                                        </select>
                                        <div class="error-messages" ng-if="interacted(myForm.examoption)" ng-messages="myForm.examoption.$error">
                                            <div ng-message="required">Select Subject</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="sel2" class="control-label col-sm-4">Report Type : <span style="color:Red">*</span></label>
                                    <div class="col-sm-8">
                                        <select class="form-control" id="sel12vvdd" name="reportoption" ng-model="Flag" required>
                                            <option value="">--Select--</option>
                                            <option value="Average">Average</option>
                                            <option value="Best">Best</option>
                                        </select>
                                        <div class="error-messages" ng-if="interacted(myForm.reportoption)" ng-messages="myForm.reportoption.$error">
                                            <div ng-message="required">Select Report Type</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="sel2" class="control-label col-sm-4">Best : <span style="color:Red">*</span></label>
                                    <div class="col-sm-8">
                                        <input class="form-control" name="bestd" ng-model="bestcount" id="usr" type="text" allow-pattern="(\s|[0-9])" maxlength="2" ng-required="Flag=='Best'" ng-disabled="Flag=='Average'">
                                        <div class="error-messages" ng-if="interacted(myForm.bestd)" ng-messages="myForm.bestd.$error">
                                            <div ng-message="required">Enter The Best </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <div class="text-center">
                                        <md-button type="button" class="md-raised md-primary" ng-click="Getreport()" ng-disabled="form.$invalid" id="save-btn">
                                            <i class="fa fa-file " aria-hidden="true"></i>
                                            Report
                                        </md-button>
                                        <md-button type="button" class="md-raised md-warn" ng-click="cancel()">
                                            <i class="fa fa-times" aria-hidden="true"></i>
                                            Cancel
                                        </md-button>
                                        <!--<md-button type="button" class="md-raised md-primary" ng-disabled="reportd" ng-click="printToCart()">
                                            <i class="fa fa-print" aria-hidden="true"></i>
                                            Print
                                        </md-button>-->
                                        <md-button type="button" class="md-raised md-primary" id="excel-btn" ng-disabled="reportd" aria-disabled="false"
                                                   ng-click="exportToExcel('#Baldwin')">
                                            <i class="fa-file-excel-o " aria-hidden="true"></i>
                                            Excel
                                        </md-button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr />
                </div>
            </div>
        </div>
    </form>

    <div class="box box-primary" ng-show="datagriv">
        <div class="box-header with-border">
            <h3 class="box-title">Data Grid View</h3>
            <div class="box-tools pull-right">
                <button type="button" class="btn btn-box-tool" data-widget="collapse" data-placement="bottom" data-toggle="tooltip" title="collapsible"><i class="fa fa-minus"></i></button>
            </div>

        </div>
        <!-- /.box-header -->
        <div class="box-body" style="overflow:scroll">
            <div id="Baldwin" class="CumulativeReportBB">
                <table>
                    <tr>
                        <td colspan="{{colspan}}" style="text-align:center ; border: solid 0.5px black ;" class="text-center">
                            <h3><b> {{inst_name}}</b></h3>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="{{colspan}}" style="text-align:center ; border: solid 0.5px black ;" class="text-center">
                            <h3><b> CUMULATIVE REPORT</b></h3>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="{{colspan}}" style="text-align:center ; border: solid 0.5px black ;" class="text-center">
                            <h3><b> ACADEMIC YEAR  : {{yearname}}</b></h3>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="{{colspan}}" style="text-align:center ; border: solid 0.5px black ;" class="text-center">
                            <h3><b>Subject :  {{subjectname}}</b></h3>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="{{colspan}}" style="text-align:center ; border: solid 0.5px black ;" class="text-center">
                            <h3><b>COURSE :  {{cour}} &nbsp;&nbsp;  BRANCH :  {{branc}} &nbsp;&nbsp;  SEMESTER :  {{semestername}} &nbsp;&nbsp; SECTION :  {{sectionname}} </b></h3>
                        </td>
                    </tr>
                </table>
                <br />
                <table class="table table-hover table-responsive table-bordered" id="tabledb">
                    <thead>
                        <tr style="border: solid 0.5px black ;">
                            <th><b></b>Sl No</th>
                            <th><b>Student Name</b></th>
                            <th style="width:150px"><b>Register No</b></th>
                            <th ng-repeat="column in examid "><b> {{column.EME_ExamName}} Marks</b></th>
                            <th><b>FInal Marks</b> </th>
                            <th><b>CLASS HELD</b> </th>
                            <th><b>ATTENDANCE</b></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style="border: solid 0.5px black ;" ng-repeat="user in reportdata | orderBy:sortKey:reverse |  filter:search">
                            <td class="text-center">{{ $index+1}}</td>
                            <td class="text-left padding-left-5">{{ user.STUDENTNAME }} </td>
                            <td class="text-left" ng-show="regno">{{ user.REGNO }} </td>
                            <td class="text-center" ng-repeat="subj in examid">
                                <span> {{user[subj.EME_Id]}}</span>
                            </td>
                            <td class="text-center">{{ user.final }}</td>
                            <td class="text-center">{{ user.CLASSHELD }}</td>
                            <td class="text-center"> {{ user.PRESENT }}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</section>