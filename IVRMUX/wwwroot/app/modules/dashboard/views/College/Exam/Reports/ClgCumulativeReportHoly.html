<section class="content">
    <form class="form-horizontal ng-pristine ng-valid" name="myForm" role="form" novalidate>
        <div data-ng-init="BindData()">
            <div class="box box-primary">
                <div class="box-header with-border">
                    <h3 class="box-title">Cumulative Report</h3>
                    <div class="box-tools pull-right">
                        <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                    </div>
                </div>
                <div class="box-body">
                    <div class="row">
                        <div class="col-sm-6 col-sm-offset-3 text-center">
                            <div class="well">
                                <div ng-init="rdopunch='Format_I'">
                                    <label class="radio-inline">
                                        <input type="radio" value="Format_I" name="enhc" ng-model="rdopunch" ng-change="otherdaydatechange()">
                                        <span class="lbl padding-8"><b> Format_I </b></span>
                                    </label>
                                    <label class="radio-inline">
                                        <input type="radio" value="Format_II" name="enhc" ng-model="rdopunch" ng-change="otherdaydatechange()">
                                        <span class="lbl padding-8"><b>Format_II </b></span>
                                    </label>
                                </div>
                            </div>
                        </div>


                    </div>
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label class="control-label col-sm-4">Academic Year:<span style="color:Red">*</span></label>
                                    <div class="col-sm-8">
                                        <select class="form-control" id="sel11" name="coursed" ng-model="ASMAY_Id" ng-change="onchangeyear()" required>
                                            <option value="">--Select--</option>
                                            <option ng-repeat="clas in yearlist" value="{{clas.asmaY_Id}}" ng-selected="{{clas.Selected==true}}">
                                                {{clas.asmaY_Year}}
                                            </option>
                                        </select>
                                        <div class="error-messages" ng-if="interacted(myForm.coursed)" ng-messages="myForm.coursed.$error">
                                            <div ng-message="required">Please Select Year</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label class="control-label col-sm-4">Course:<span style="color:Red">*</span></label>
                                    <div class="col-sm-8">
                                        <select class="form-control" id="sel1" name="course" ng-model="AMCO_Id" ng-change="onchangecourse()" required>
                                            <option value="">--Select--</option>
                                            <option ng-repeat="clas in course_list" value="{{clas.amcO_Id}}" ng-selected="{{clas.Selected==true}}">
                                                {{clas.amcO_CourseName}}
                                            </option>
                                        </select>
                                        <div class="error-messages" ng-if="interacted(myForm.course)" ng-messages="myForm.course.$error">
                                            <div ng-message="required">Please Select Course</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label class="control-label col-sm-4">Branch:<span style="color:Red">*</span></label>
                                    <div class="col-sm-8">
                                        <select class="form-control" id="sel1" name="branc" ng-model="AMB_Id" ng-change="onchangebranch()" required>
                                            <option value="">--Select--</option>
                                            <option ng-repeat="bran in branch_list" value="{{bran.amB_Id}}" ng-selected="{{bran.Selected==true}}">
                                                {{bran.amB_BranchName}}
                                            </option>
                                        </select>
                                        <div class="error-messages" ng-if="interacted(myForm.branc)" ng-messages="myForm.branc.$error">
                                            <div ng-message="required">Please Select Branch</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label for="sel2" class="control-label col-sm-4">Semester:<span style="color:Red">*</span></label>
                                    <div class="col-sm-8">
                                        <select class="form-control" id="sel12vv" name="semis" ng-model="AMSE_Id" ng-change="onchangesemester()" required>
                                            <option value="">--Select--</option>
                                            <option ng-repeat="semi in semisters_list" value="{{semi.amsE_Id}}" ng-selected="{{semis.Selected==true}}">
                                                {{semi.amsE_SEMName}}
                                            </option>
                                        </select>
                                        <div class="error-messages" ng-if="interacted(myForm.semis)" ng-messages="myForm.semis.$error">
                                            <div ng-message="required">Select Semester</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-sm-12">
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label class="control-label col-sm-4">Section :<span style="color:Red">*</span></label>
                                    <div class="col-sm-8">
                                        <select class="form-control" id="sm" name="secdd" ng-model="ACMS_Id" required>
                                            <option value="">Select</option>
                                            <option ng-repeat="sec in seclist" value="{{sec.acmS_Id}}" ng-selected="{{sec.Selected == true}}">{{sec.acmS_SectionName}}</option>
                                        </select>
                                        <div class="error-messages" ng-if="interacted(myForm.secdd)" ng-messages="myForm.secdd.$error">
                                            <div ng-message="required">Please Select Section</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6 ">
                                <div class="form-group">
                                    <label class="control-label col-sm-4">Subject Scheme:<span style="color:Red">*</span></label>
                                    <div class="col-sm-8">
                                        <select class="form-control" id="sel12" name="sschemas" ng-model="ACSS_Id" ng-change="onchangesubjectscheme()" required>
                                            <option value="">--Select--</option>
                                            <option ng-repeat="sschema in subjectschema_list" value="{{sschema.acsS_Id}}" ng-selected="{{sschema.Selected==true}}">
                                                {{sschema.acsS_SchmeName}}
                                            </option>
                                        </select>
                                        <div class="error-messages" ng-if="interacted(myForm.sschemas)" ng-messages="myForm.sschemas.$error">
                                            <div ng-message="required">Please Select Subject Scheme</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>

                    <div class="row">
                        <div class="col-sm-12">
                            <div class="col-sm-6 ">
                                <div class="form-group">
                                    <label class="control-label col-sm-4">Scheme Type:<span style="color:Red">*</span></label>
                                    <div class="col-sm-8">
                                        <select class="form-control" id="sel165" name="schematype" ng-change="onchangeschemetype()" ng-model="ACST_Id" required>
                                            <option value="">--Select--</option>
                                            <option ng-repeat="scmatype in schmetype_list" value="{{scmatype.acsT_Id}}" ng-selected="{{scmatype.Selected==true}}">
                                                {{scmatype.acsT_SchmeType}}
                                            </option>
                                        </select>
                                        <div class="error-messages" ng-if="interacted(myForm.schematype)" ng-messages="myForm.schematype.$error">
                                            <div ng-message="required">Please Select Scheme Type</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label for="sel2" class="control-label col-sm-4">Exam: <span style="color:Red">*</span></label>
                                    <div class="col-sm-8">
                                        <select class="form-control" id="sel12vvdd" name="examoption" ng-model="EME_Id" required>
                                            <option value="">--Select--</option>
                                            <option ng-repeat="exam in exam_list" value="{{exam.emE_Id}}" ng-selected="{{exam.Selected==true}}">
                                                {{exam.emE_ExamName}}
                                            </option>
                                        </select>
                                        <div class="error-messages" ng-if="interacted(myForm.examoption)" ng-messages="myForm.examoption.$error">
                                            <div ng-message="required">Select Exam</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>

                    </div>
                    <hr />
                    <div class="">
                        <div class="">
                            <div class="text-center">
                                <input type="hidden" ng-model="EME_ID" />
                                <md-button type="submit" class="md-raised md-primary" ng-click="Getreport()" ng-disabled="form.$invalid" id="save-btn">
                                    <i class="fa fa-list-alt " aria-hidden="true"></i>
                                    Report
                                </md-button>
                                <md-button type="submit" class="md-raised md-warn" ng-click="cancel()">
                                    <i class="fa fa-times" aria-hidden="true"></i>
                                    Cancel
                                </md-button>
                                <md-button type="button" class="md-raised md-primary" ng-click="printToCart()">
                                    <i class="fa fa-file-pdf-o" aria-hidden="true"></i>
                                    Print
                                </md-button>
                                <md-button type="submit" class="md-raised md-primary" id="excel-btn" aria-disabled="false" ng-click="exportToExcel('#tabledb')">
                                    <i class="fa fa-file-excel-o" aria-hidden="true"></i>
                                    Excel
                                </md-button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </form>

    <div class="box box-primary" ng-show="datagriv">
        <div class="box-header with-border">
            <h3 class="box-title">Data Grid View</h3>
            <div class="box-tools pull-right">
                <button type="button" class="btn btn-box-tool" data-widget="collapse" data-placement="bottom" data-toggle="tooltip" title="collapsible"><i class="fa fa-minus"></i></button>
            </div>

        </div>
        <!-- /.box-header -->
        <div class="box-body" style="overflow:scroll">
            <div class="row">
                <div class="col-sm-6">
                    <div class="form-group">
                        <label class="control-label col-sm-4">Font Size :</label>
                        <div class="col-sm-4">
                            <select class="form-control" id="sel125" ng-model="size">
                                <option value="" label="Select Font Size"> </option>
                                <option ng-repeat="font in fonts" value="{{font.size}}">
                                    {{font.name}}
                                </option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <div id="Baldwin" class="CumulativeReportBB">
                <h3 class="text-center">
                    {{inst_name}}
                </h3>
                <h5 class="text-center">
                    CUMULATIVE REPORT FOR ACADEMIC YEAR {{yearname}}
                </h5>
                <h5 class="text-center">
                    EXAM :  {{exmmid}}
                </h5>
                <div class="row text-uppercase" style="font-size:{{size}} !important">
                    <div class="col-sm-12">
                        <div class="col-sm-6">
                            <b>COURSE :  {{cour}} </b>
                        </div>
                        <div class="col-sm-6">
                            <b>BRANCH :  {{branc}} </b>
                        </div>
                    </div>
                </div>
                <div class="row text-uppercase" style="font-size:{{size}} !important">
                    <div class="col-sm-12">
                        <div class="col-sm-6">
                            <b>SEMESTER :  {{semestername}} </b>
                        </div>
                        <div class="col-sm-6">
                            <b>SECTION :  {{sectionname}} </b>
                        </div>
                    </div>
                </div>
                <table class="table table-hover table-responsive table-bordered text-center" id="tabledb" ng-if="rdopunch=='Format_I'">
                    <thead>
                        <tr>
                            <th><b></b><a href="">Sl No</a> </th>
                            <th><b><a href="" ng-click="sort('amsT_FirstName')">Student Name</a> </b></th>
                            <th ng-if="regno"><b><a href="" ng-click="sort('amsT_AdmNo')">Reg No</a> </b></th>
                            <th ng-repeat="column in studentslt1 "><b> {{column.ismS_SubjectName}}  </b></th>
                            <th ng-if="studentslt1.length >0"><b><a href="" ng-click="sort('ecstmP_TotalObtMarks')">Total</a></b> </th>
                            <th ng-if="studentslt1.length >0"><b><a href="" ng-click="sort('ecstmP_SectionRank')">Section Rank</a> </b></th>
                            <th><b><a href="" ng-click="sort('classheld')">CLASS HELD</a></b> </th>
                            <th><b><a href="" ng-click="sort('classatt')">ATTENDANCE</a> </b></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="user in studentslt | orderBy:sortKey:reverse |  filter:search">
                            <td>{{ $index+1}}</td>
                            <td class="text-left padding-left-5">{{ user.amsT_FirstName }} </td>
                            <td ng-if="regno">{{ user.amsT_AdmNo }} </td>
                            <td ng-repeat="subj in user.sub_list">
                                <span>{{ subj.hema_ecstmpS_ObtainedMarks }}</span>
                            </td>
                            <td ng-if="studentslt1.length >0">{{ user.ecstmP_TotalObtMarks }}</td>
                            <td ng-if="studentslt1.length >0">
                                <span ng-if="user.ecstmP_SectionRank != '0'">
                                    {{ user.ecstmP_SectionRank }}
                                </span><span ng-if="user.ecstmP_SectionRank == '0'"></span>
                            </td>
                            <td>{{ user.classheld }}</td>
                            <td>{{ user.classatt }}</td>

                        </tr>
                        <tr>
                            <td></td>
                            <td>
                                <strong> TOTAL NO OF STUDENTS </strong>
                            </td>
                            <td ng-repeat="column in studentslt1 ">
                                <span ng-repeat="sub in TotalStudents" ng-if="sub.TotalStudents =='TotalStudents' && column.ismS_Id==sub.ISMS_Id">

                                    {{sub.countTotalStudents}}
                                </span>
                            </td>
                            <td ng-if="studentslt1.length >0"> </td>
                            <td ng-if="studentslt1.length >0"></td>
                            <td> </td>
                            <td></td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>
                                <strong>   APPEARED STUDENTS </strong>

                            </td>
                            <td ng-repeat="column in studentslt1 ">
                                <span ng-repeat="sub in TotalStudents" ng-if="sub.TotalStudents =='AppearedStudents' && column.ismS_Id==sub.ISMS_Id">

                                    {{sub.countTotalStudents}}
                                </span>
                            </td>
                            <td ng-if="studentslt1.length >0"> </td>
                            <td ng-if="studentslt1.length >0"></td>
                            <td> </td>
                            <td></td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>
                                <strong>   ABSENT </strong>

                            </td>
                            <td ng-repeat="column in studentslt1 ">
                                <span ng-repeat="sub in TotalStudents" ng-if="sub.TotalStudents =='AbsentStudents' && column.ismS_Id==sub.ISMS_Id">

                                    {{sub.countTotalStudents}}
                                </span>
                            </td>
                            <td ng-if="studentslt1.length >0"> </td>
                            <td ng-if="studentslt1.length >0"></td>
                            <td> </td>
                            <td></td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>
                                <strong>   FAIL </strong>

                            </td>
                            <td ng-repeat="column in studentslt1 ">
                                <span ng-repeat="sub in TotalStudents" ng-if="sub.TotalStudents =='FailedStudents' && column.ismS_Id==sub.ISMS_Id">

                                    {{sub.countTotalStudents}}
                                </span>
                            </td>
                            <td ng-if="studentslt1.length >0"> </td>
                            <td ng-if="studentslt1.length >0"></td>
                            <td> </td>
                            <td></td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>
                                <strong>   PASS </strong>

                            </td>
                            <td ng-repeat="column in studentslt1 ">
                                <span ng-repeat="sub in TotalStudents" ng-if="sub.TotalStudents =='PassedStudents' && column.ismS_Id==sub.ISMS_Id">

                                    {{sub.countTotalStudents}}
                                </span>
                            </td>
                            <td ng-if="studentslt1.length >0"> </td>
                            <td ng-if="studentslt1.length >0"></td>
                            <td> </td>
                            <td></td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>
                                <strong>   PERCENTAGE </strong>

                            </td>
                            <td ng-repeat="column in studentslt1 ">
                                <span ng-repeat="sub in TotalStudents" ng-if="sub.TotalStudents=='Percentage' && column.ismS_Id==sub.ISMS_Id">

                                    {{sub.countTotalStudents}} %
                                </span>
                            </td>
                            <td ng-if="studentslt1.length >0"> </td>
                            <td ng-if="studentslt1.length >0"></td>
                            <td> </td>
                            <td></td>
                        </tr>
                    </tbody>
                </table>

                <table class="table table-hover table-responsive table-bordered text-center" id="tabledb" ng-if="rdopunch=='Format_II'">
                    <thead>
                        <tr>
                            <th>
                                SL NO
                            </th>
                            <th>
                                SUBJECT
                            </th>
                            <th>
                                STAFF NAME
                            </th>
                            <th>
                                Total
                            </th>
                            <th>
                                Appeared
                            </th>
                            <th>
                                Absent
                            </th>
                            <th>
                                Fail
                            </th>
                            <th>
                                Pass
                            </th>

                            <th>
                                Percentage
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                    <tbody ng-repeat="user in employeeid">

                        <tr>
                            <td>
                                {{$index+1}}
                            </td>
                            <td class="text-left" rowspan="{{user.schmetypelist.length+1}}"><b>{{user.ISMS_SubjectName}}</b></td>
                            <td class="text-left" rowspan="{{user.schmetypelist.length+1}}"><b>{{user.EmployeeName}}</b></td>
                            <td ng-repeat="emp in schmetypelistTemp" ng-if="emp.TotalStudents=='TotalStudents'">
                                <span ng-repeat="emplist in user.schmetypelist" ng-if="emplist.ISMS_Id==user.ISMS_Id && emplist.TotalStudents=='TotalStudents'">
                                    {{emplist.countTotalStudents}}

                                </span>
                            </td>
                            <td ng-repeat="emp in schmetypelistTemp" ng-if="emp.TotalStudents=='AppearedStudents'">
                                <span ng-repeat="emplist in schmetypelist" ng-if="emplist.ISMS_Id==user.ISMS_Id && emplist.TotalStudents=='AppearedStudents'">
                                    {{emplist.countTotalStudents}}

                                </span>
                            </td>
                            <td ng-repeat="emp in schmetypelistTemp" ng-if="emp.TotalStudents=='AbsentStudents'">
                                <span ng-repeat="emplist in schmetypelist" ng-if="emplist.ISMS_Id==user.ISMS_Id && emplist.TotalStudents=='AbsentStudents'">
                                    {{emplist.countTotalStudents}}

                                </span>
                            </td>
                            <td ng-repeat="emp in schmetypelistTemp" ng-if="emp.TotalStudents=='FailedStudents'">
                                <span ng-repeat="emplist in schmetypelist" ng-if="emplist.ISMS_Id==user.ISMS_Id && emplist.TotalStudents=='FailedStudents'">
                                    {{emplist.countTotalStudents}}

                                </span>
                            </td>
                            <td ng-repeat="emplist in schmetypelist" ng-if="emplist.ISMS_Id==user.ISMS_Id && emplist.TotalStudents=='PassedStudents'">
                                <span ng-repeat="emplist in schmetypelist" ng-if="emplist.ISMS_Id==user.ISMS_Id && emplist.TotalStudents=='PassedStudents'">
                                    {{emplist.countTotalStudents}}

                                </span>
                            </td>
                            <td ng-repeat="emplist in schmetypelist" ng-if="emplist.ISMS_Id==user.ISMS_Id && emplist.TotalStudents=='Percentage'">
                                <span ng-repeat="emplist in schmetypelist" ng-if="emplist.ISMS_Id==user.ISMS_Id && emplist.TotalStudents=='Percentage'">
                                    {{emplist.countTotalStudents}} %
                                </span>
                            </td>

                        </tr>
                    </tbody>

                </table>

            </div>
        </div>
    </div>

</section>