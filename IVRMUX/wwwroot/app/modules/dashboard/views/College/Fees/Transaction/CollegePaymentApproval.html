

<div data-ng-init="loaddata()">

    <section class="content">
        <form class="form-horizontal ng-pristine ng-valid" role="form" name="myForm" novalidate>
            <div class="box box-primary">
                <div class="box-header with-border">
                    <h3 class="box-title"> Fee Payment Approval</h3>
                    <div class="box-tools pull-right">
                        <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                    </div>
                </div>
                <div class="box-body">

                    <div class="row col-sm-offset-4">

                        <div class="col-sm-6">
                            <div class="form-group">
                                <label class="control-label col-sm-4">
                                    Academic Year :<strong style="color:red;">*</strong>
                                </label>
                                <div class="col-sm-8">
                                    <select class="form-control" id="sel1" data-ng-model="cfg.ASMAY_Id" name="acd_year" ng-change="getyear(cfg.ASMAY_Id)" required>
                                        <option value="">Select Year</option>
                                        <option ng-repeat="options in arrlist6" value="{{options.asmaY_Id}}" ng-selected="{{options.asmaY_Id == cfg.ASMAY_Id}}">
                                            {{options.asmaY_Year}}
                                        </option>
                                    </select>
                                    <div class="error-messages" ng-if="interacted(myForm.acd_year)" ng-messages="myForm.acd_year.$error">
                                        <div ng-message="required">Please Select Academic Year</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div class="row col-sm-offset-4">
                        <div class="col-sm-6">
                            <div class="form-group" id="frmdt">
                                <label class="control-label col-sm-4">From Date:<span style="color:red;">*</span></label>
                                <div class="col-sm-8 input-group" style="">
                                    <md-datepicker ng-model="fromDate" md-min-date="minDatemf" md-max-date="maxDatemf" onkeydown="return false" name="From_Date" id="date1" md-placeholder="Enter  date" required></md-datepicker><!--ng-change='setTodate(fromDate)'-->
                                </div>
                                <div class="error-messages" ng-if="interacted(myForm.From_Date)" ng-messages="myForm.From_Date.$error">
                                    <div ng-message="required" style="margin-left:195px;">Please Select Date</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row col-sm-offset-4">
                        <div class="col-sm-6">
                            <div class="form-group" id="frmdt">
                                <label class="control-label col-sm-4">To Date:<span style="color:red;">*</span></label>

                                <div class="col-sm-8 input-group ">
                                    <md-datepicker ng-model="todate" onkeydown="return false"
                                                   md-min-date="minDatemf" md-max-date="maxDatemf" name="To_Date" id="date2" md-placeholder="Enter  date" required></md-datepicker><!--ng-change='checkErr(fromDate,todate)'-->
                                </div>
                                <div class="error-messages" ng-if="interacted(myForm.To_Date)" ng-messages="myForm.To_Date.$error">
                                    <div ng-message="required" style="margin-left:195px;">Please Select Date</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr />
                    <div class="text-center">

                        <md-button type="button" class="md-raised md-primary" ng-disabled="form.$invalid" id="save-btn" ng-click="ShowReport()">
                            <i class="fa fa-edit" aria-hidden="true"></i>
                            Get
                        </md-button>

                        <md-button type="button" class="md-raised md-warn" id="clear-btn" ng-click="Cancel()">Clear</md-button>

                    </div>
                </div>

            </div>



            <div class="box box-primary" ng-show="Grid_View">
                <div class="box-header with-border">
                    <h3 class="box-title"> Fee Payment Approval</h3>
                    <div class="box-tools pull-right">
                        <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                    </div>
                </div>
                <div class="box-body">




                    <table class="table table-bordered table-condensed">
                        <thead>

                            <tr>
                                <td style="width:5%;">
                                    <label>
                                        <input type="checkbox" ng-model="selectedAllstu" ng-click="toggleAllstu(selectedAllstu)" />
                                        <span class="lbl padding-8"></span>
                                    </label>
                                </td>
                                <th style="width:25%;">
                                    Name/ Course/ Branch/Admission No
                                </th>
                                <!--<th style="width:10%;">Admission No</th>-->
                                <th style="width:10%;"> Receipt No</th>
                                <th style="width:10%;">Paid Date <br /> Paid Amount</th>
                                <th style="width:10%;">Clearance  Date</th>
                                <!--<th style="width:10%;">Paid Amount</th>-->
                                <th style="width:10%;">User Details</th>
                                <th style="width:15%;">Mode of Payment</th>

                                <th style="width:15%;">Remark</th>
                            </tr>
                        </thead>
                    </table>
                    <div class="panel-group accordion">

                        <div class="panel panel-default" ng-repeat="user1 in plannerid">
                            <div class="boxlayout" data-toggle="collapse" data-parent=".accordion" data-target="#collapse{{$index+1}}" href="#collapse{{$index+1}}">
                                <div class="row">

                                    <div class="col-sm-12">
                                        <table class="table table-bordered table-condensed">

                                            <tbody>

                                                <tr>
                                                    <td style="width:5%;">
                                                        <label>
                                                            <input name="option[]" value="1" type="checkbox" ng-model="user1.studchecked">
                                                            <span class="lbl padding-8"></span>
                                                        </label>


                                                    </td>
                                                    <td style="width:25%;">
                                                        {{ user1.AMCST_FirstName}} <span ng-if="user1.AMCST_MiddleName !== null" class="lbl padding-8">  {{ user1.AMCST_MiddleName}} {{ user1.AMCST_LastName}} </span>/
                                                        {{ user1.AMCO_CourseName}}  /
                                                        {{ user1.AMB_BranchName}}/
                                                        {{ user1.AMCST_AdmNo}}
                                                    </td>
                                                    <!--<td style="width:10%;">{{ user1.AMCST_AdmNo}}</td>-->
                                                    <td style="width:10%;">{{ user1.FYP_ReceiptNo}}</td>
                                                    <td style="width:10%;">
                                                        {{user1.FYP_ReceiptDate |date:'dd-MM-yyyy'}}/
                                                        <br />{{user1.FYP_TotalPaidAmount}}
                                                    </td>
                                                    <td style="width:10%">{{user1.FYPPM_ClearanceDate  |date:'dd-MM-yyyy'}}</td>

                                                    <td style="width:10%;">{{user1.NormalizedUserName}}</td>

                                                    <td style="width:15%">
                                                        Mode: {{user1.FYP_Bank_Or_Cash}}
                                                        <span ng-if="user1.FYP_Bank_Or_Cash!='C'">
                                                            /
                                                            <br />
                                                            Bank Name : {{user1.FYP_Bank_Name}}
                                                            <br />
                                                            Check No : {{user1.FYPPM_DDChequeNo}}
                                                            <br />
                                                            Check Date : {{user1.FYPPM_DDChequeDate  |date:'dd-MM-yyyy'}}
                                                        </span>
                                                    </td>
                                                    <td style="width:15%;">{{user1.FYP_Remarks}}</td>
                                                    <td hidden="hidden">{{ user1.FYP_Id}}</td>
                                                    <td hidden="hidden">{{ user1.FYT_Id}}</td>
                                                </tr>
                                            </tbody>
                                        </table>

                                    </div>
                                </div>
                            </div>
                            <div class="panel-collapse collapse" id="collapse{{$index+1}}">

                                <div class="panel-body">
                                    <table class="table table-responsive table-bordered text-center">
                                        <thead>
                                            <tr>
                                                <th colspan="7">
                                                    Regular Fee Collection
                                                </th>
                                            </tr>
                                            <tr>


                                                <th style="width:200px;">
                                                    <a href="" ng-click="order('FeeHead')">Fee Head</a>
                                                </th>
                                                <th style="width:120px;">
                                                    <a href="" ng-click="order('Installment')">Installment</a>
                                                </th>
                                                <th><a href="" ng-click="order('Opening Balance')">Opening Balance</a> </th>
                                                <th>
                                                    <a href="" ng-click="order('currentcharges')">Current Charges</a>
                                                </th>
                                                <th>
                                                    <a href="" ng-click="order('totalcharges')">Total Charges</a>
                                                </th>
                                                <th>
                                                    <a href="" ng-click="order('FCSS_ConcessionAmount')">Concession</a>
                                                </th>

                                                <th><a href="" ng-click="order('FTCP_PaidAmount')">PaidAmount</a> </th>

                                            </tr>
                                        </thead>

                                        <tbody ng-repeat="feehead in user1.feeinstallmentdata">

                                            <tr>

                                                <td ng-mouseover="positive()" ng-mouseleave="negative()" title="{{feehead.FMG_GroupName}}">
                                                    {{feehead.FMH_FeeName}}
                                                </td>
                                                <td hidden="hidden">{{feehead.FMH_Id}}</td>
                                                <td>
                                                    {{feehead.FTI_Name}}
                                                </td>
                                                <td hidden="hidden">{{feehead.FTI_Id}}</td>

                                                <td hidden="hidden">{{feehead.FMA_Id}}</td>

                                                <td>
                                                    {{feehead.FCSS_OBArrearAmount}}
                                                </td>

                                                <td>
                                                    {{feehead.FCSS_NetAmount}}
                                                </td>

                                                <td>
                                                    {{feehead.FCSS_TotalCharges}}
                                                </td>
                                                <td>
                                                    {{feehead.FCSS_ConcessionAmount}}
                                                </td>
                                                <td>
                                                    {{feehead.FTCP_PaidAmount}}
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>

                                    <table class="table table-responsive table-bordered text-center" ng-if="user1.filladvancedetails.length>0">
                                        <thead>
                                            <tr>
                                                <th colspan="7">
                                                    Advance Fee Collection
                                                </th>
                                            </tr>
                                            <tr>


                                                <th style="width:200px;">
                                                    <a href="" ng-click="order('FeeHead')">Fee Head</a>
                                                </th>
                                                <th style="width:120px;">
                                                    <a href="" ng-click="order('Installment')">Installment</a>
                                                </th>
                                                <th><a href="" ng-click="order('Opening Balance')">Opening Balance</a> </th>
                                                <th>
                                                    <a href="" ng-click="order('currentcharges')">Current Charges</a>
                                                </th>
                                                <th>
                                                    <a href="" ng-click="order('totalcharges')">Total Charges</a>
                                                </th>
                                                <th>
                                                    <a href="" ng-click="order('FCSS_ConcessionAmount')">Concession</a>
                                                </th>

                                                <th><a href="" ng-click="order('FTCP_PaidAmount')">PaidAmount</a> </th>

                                            </tr>
                                        </thead>

                                        <tbody ng-repeat="advance in user1.filladvancedetails">

                                            <tr>

                                                <td ng-mouseover="positive()" ng-mouseleave="negative()" title="{{advance.FMG_GroupName}}">
                                                    {{advance.FMH_FeeName}}
                                                </td>
                                                <td hidden="hidden">{{advance.FMH_Id}}</td>
                                                <td>
                                                    {{advance.FTI_Name}}
                                                </td>
                                                <td hidden="hidden">{{advance.FTI_Id}}</td>

                                                <td hidden="hidden">{{advance.FMA_Id}}</td>

                                                <td>
                                                    {{advance.FCSS_OBArrearAmount}}
                                                </td>

                                                <td>
                                                    {{advance.FCSS_NetAmount}}
                                                </td>

                                                <td>
                                                    {{advance.FCSS_TotalCharges}}
                                                </td>
                                                <td>
                                                    {{advance.FTCP_ConcessionAmount}}
                                                </td>
                                                <td>
                                                    {{advance.FTCP_PaidAmount}}
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>

                                    <table class="table table-responsive table-bordered text-center" ng-if="user1.fillremarks.length>0">
                                        <thead>
                                            <tr>

                                                <th style="width:120px;">
                                                    <a href="" ng-click="order('EmployeeName')">Approvar Name</a>
                                                </th>
                                                <th style="width:200px;">
                                                    <a href="" ng-click="order('FYPAPP_Remarks')">Approver Remark</a>
                                                </th>



                                            </tr>
                                        </thead>

                                        <tbody ng-repeat="remark in user1.fillremarks">

                                            <tr>

                                                <td>
                                                    {{remark.EmployeeName}}
                                                </td>
                                                <td>
                                                    {{remark.FYPAPP_Remarks}}
                                                </td>

                                            </tr>
                                        </tbody>
                                    </table>


                                    <div class="col-sm-6 ">
                                        <label class="control-label col-sm-4">Remark :<span style="color:Red"></span></label>
                                        <div class="col-sm-8">
                                            <textarea class="form-control" name="Remark" type="text" placeholder="Remark .... " ng-model="user1.FYPAPP_Remarks" rows="5" style="resize:none"></textarea>

                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>


                    <div class="form-group">
                        <!--<div class="col-sm-6 ">
                            <label class="control-label col-sm-4">Remark :<span style="color:Red"></span></label>
                            <div class="col-sm-8">
                                <textarea class="form-control" name="Remark" type="text" placeholder="Remark .... " ng-model="remark" rows="5"  style="resize:none"></textarea>
                            </div>
                        </div>-->
                        <div class="col-sm-6">
                            <div class="col-sm-12">
                                <br />
                                <md-button type="button" class="md-raised md-primary" ng-click="approve(plannerid,remark,user1.feeinstallmentdata)">
                                    Approve
                                </md-button>

                                <md-button type="button" class="md-raised md-warn" ng-click="rejected(plannerid,remark,user1.feeinstallmentdata)">
                                    Rejected
                                </md-button>
                            </div>
                        </div>
                    </div>


                </div>
            </div>


        </form>



    </section>
</div>

