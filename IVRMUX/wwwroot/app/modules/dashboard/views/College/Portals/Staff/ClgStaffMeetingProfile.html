<script src='https://meet.jit.si/external_api.js'></script>
<script>
    //function loadvalues(hostid, id) {
    function loadvalues(hostid) {
        debugger;


        var json_data = hostid.getAttribute("data-filterListId");

        var obj = JSON.parse(json_data);

        //angular.element(document.querySelector('[ng-controller="StaffMeetingProfileController"]')).scope().ondatechange();
        //var scope = angular.element(document.getElementById('idForJS')).scope();
        //scope.onstartmeeting(obj.lmslmeeT_Id);
        debugger;
        var hostname = obj.name;


        var roomName = obj.lmslmeeT_MeetingId;


        if (hostname != '' && roomName != '') {
            const domain = 'meet.jit.si';
            const options = {
                roomName: roomName,
                parentNode: document.querySelector('#meet'),
                configOverwrite: {
                    startWithAudioMuted: false,
                    constraints: {
                        video: {
                            height: {
                                ideal: 720,
                                max: 720,
                                min: 240
                            }
                        }
                    },
                    desktopSharingChromeDisabled: false,
                    liveStreamingEnabled: true,
                    enableWelcomePage: false,
                    enableCalendarIntegration: false,
                    gatherStats: true,
                    enableDisplayNameInStats: true,
                    disableInviteFunctions: false,
                    fileRecordingsEnabled: true,
                    fileRecordingsServiceEnabled: true,
                    enableDisplayNameInStats: false,
                    enableEmailInStats: true,
                    enableNoAudioDetection: true,
                    enableNoisyMicDetection: true,
                    useNicks: false,
                    enableClosePage: true,
                    enableUserRolesBasedOnToken: true,
                    enableFeaturesBasedOnToken: true,
                    lockRoomGuestEnabled: true,
                    gatherStats: true,
                    localRecording: {
                        enabled: true,
                        format: 'flac'
                    },
                    //remoteVideoMenu: {
                    //    disableKick: true
                    //},
                    disableRemoteMute: true,
                    desktopSharingChromeSources: ['window', 'tab'],

                },
                interfaceConfigOverwrite: {
                    SHOW_JITSI_WATERMARK: false,
                    JITSI_WATERMARK_LINK: '',
                    SHOW_WATERMARK_FOR_GUESTS: false,
                    DEFAULT_BACKGROUND: 'rgb(109, 128, 169)',
                    DEFAULT_LOCAL_DISPLAY_NAME: hostname,
                    //DEFAULT_REMOTE_DISPLAY_NAME: hostname,
                    DISPLAY_WELCOME_PAGE_CONTENT: false,
                    GENERATE_ROOMNAMES_ON_WELCOME_PAGE: false,
                    TOOLBAR_BUTTONS: [
                        'microphone', 'camera', 'closedcaptions', 'desktop', 'fullscreen',
                        'fodeviceselection', 'profile', 'chat',
                        'livestreaming', 'etherpad', 'sharedvideo', 'settings', 'raisehand',
                        'videoquality', 'filmstrip', 'invite', 'feedback', 'stats', 'shortcuts',
                        'tileview', 'download', 'help', 'mute-everyone', 'security'
                    ],
                    DISABLE_FOCUS_INDICATOR: true,
                    DISABLE_DOMINANT_SPEAKER_INDICATOR: false,
                    VIDEO_QUALITY_LABEL_DISABLED: false,
                    RECENT_LIST_ENABLED: false,
                    DISABLE_JOIN_LEAVE_NOTIFICATIONS: true,
                    CLOSE_PAGE_GUEST_HINT: true,
                    APP_NAME: 'Vaps LMS',
                    NATIVE_APP_NAME: 'Vaps LMS',
                    PROVIDER_NAME: 'Vaps',
                    desktopSharingChromeExtId: null,
                    OPTIMAL_BROWSERS: ['chrome', 'chromium', 'firefox', 'nwjs', 'electron', 'safari'],
                    DISABLE_VIDEO_BACKGROUND: true,
                    SHOW_PROMOTIONAL_CLOSE_PAGE: false,
                    CLOSE_PAGE_GUEST_HINT: false,
                    DISABLE_TRANSCRIPTION_SUBTITLES: false,
                    SUPPORT_URL: 'https://vapstech.com/',
                    SHOW_CHROME_EXTENSION_BANNER: false,
                    SETTINGS_SECTIONS: ['devices', 'language', 'moderator', 'profile']
                }
            };
            const api = new JitsiMeetExternalAPI(domain, options);

        }




        //var jsondata = {
        //    "LMSLMEET_Id": id,
        //}
        //$.ajax({
        //    //url: "http://localhost:51263/api/LiveMeetingScheduleFacade/onstartmeeting/",
        //    //crossDomain: true,
        //    //type: "POST",
        //    //"Access-Control-Allow-Origin": '*',
        //    //"Content-Type": 'application/json',
        //    //"Accept": '*/*',
        //    //data: {
        //    //    "LMSLMEET_Id": id,
        //    //},


        //    type: "post",
        //    url: "http://localhost:51263/api/LiveMeetingScheduleFacade/onstartmeeting/",
        //    data: JSON.stringify(jsondata),
        //    dataType: "json",
        //    crossDomain: true,
        //    contentType: "application/json; charset=utf-8",
        //    success: function (result) { },

        //});




    }
</script>

<section class="content" id="idForJS" data-ng-controller="ClgStaffMeetingProfileController">
    <form class="form-horizontal ng-pristine ng-valid" role="form" name="myForm" data-ng-init="onLoadGetData()" novalidate>
        <div class="box box-primary">
            <div class="box-header with-border">
                <h3 class="box-title">Meeting Profile Details</h3>
                <div class="box-tools pull-right">
                    <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                </div>
            </div>
            <div class="box-body">
                <div class="col-sm-12 well">
                    <div class="col-sm-4">
                        <div class="form-group text-center">
                            <div>
                                <img style="width:48%;height:150px;border:groove;" src="{{hrmE_Photo}}" id="blah{{$index +1}}">
                            </div>
                        </div>
                    </div>

                    <div class="col-sm-8">
                        <div class="row" style="padding:15px;">
                            <label class="control-label col-sm-2"> <b>NAME :</b></label>
                            <label class="control-label col-sm-3"> {{HRME_EmployeeFirstName}}</label>
                            <label class="control-label col-sm-3"> <b>DESIGNATION :</b></label>
                            <label class="control-label col-sm-3"> {{HRMDES_DesignationName}}</label>
                        </div>

                        <div class="row" style="padding:15px;">
                            <label class="control-label col-sm-2"> <b>DOB :</b></label>
                            <label class="control-label col-sm-3"> {{HRME_DOB |date:'dd/MM/yyyy'}}</label>
                            <label class="control-label col-sm-3"> <b>DOJ :</b></label>
                            <label class="control-label col-sm-3"> {{HRME_DOJ | date:'dd/MM/yyyy'}}</label>
                        </div>

                    </div>
                </div>


            </div>
        </div>

        <div class="box box-primary" ng-show="ttt">
            <div class="box-header with-border">
                <div class="col-sm-3">

                </div>
                <div class="col-sm-8">
                    <label class="control-label col-sm-3">Scheduled Date:<strong style="color:red;display:inline; font-weight: bolder; margin-left: 7px;">*</strong></label>
                    <md-datepicker ng-model="LMSLMEET_PlannedDate" onkeydown="return false" name="From_Date" md-max-date="maxDatemf" id="date1" md-placeholder="Enter  date" ng-change="ondatechange()" required></md-datepicker>
                </div>

                <div class="box-tools pull-right">
                    <button type="button" class="btn btn-box-tool" data-widget="collapse" data-placement="bottom" data-toggle="tooltip" title="collapsible"><i class="fa fa-minus"></i></button>
                </div>
            </div>
            <!-- /.box-header -->
            <div class="box-body">

                <div class="col-sm-6" ng-show="meetinglist.length>0" style="padding-right:20px">

                    <div class="row">
                        <h4 class="box-title"> Meeting Scheduled By- {{HRME_EmployeeFirstName}}</h4>
                    </div>
                    <div class="row">


                        <div class="col-sm-6 pull-left">
                            <div class="form-group">
                                <div class="input-group">
                                    <span class="input-group-addon">
                                        <i class="fa fa-search"></i>
                                    </span>
                                    <input class="form-control" ng-model="searchValue" type="text" placeholder="search here...">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">

                        <!--<div id="htmldiv"></div>-->

                        <div class="well" dir-paginate="mm in filterValue1 = (meetinglist | filter : searchValue)  |itemsPerPage:itemsPerPage" current-page="currentPage" ng-class-odd="'odd'">
                            <div class="row">
                                <label class="control-label col-sm-12"> <b>MEETING ID :</b><span style="color:red">{{mm.lmslmeeT_MeetingId}}</span></label>
                                <label class="control-label col-sm-12"> <b>TOPIC:</b><span style="color:forestgreen;font-size:16px;font-weight:bold">{{mm.lmslmeeT_MeetingTopic}}</span></label>
                                <label class="control-label col-sm-12">
                                    <b>DATE/TIME:</b>
                                    <span style="font-size:14px;font-weight:bold">
                                        {{mm.lmslmeeT_PlannedDate |date:'dd/MM/yyyy'}}/ ({{mm.lmslmeeT_PlannedStartTime}} To {{mm.lmslmeeT_PlannedEndTime}})
                                    </span>
                                </label>
                                <div class="col-sm-12" ng-show="mm.lmslmeeT_MeetingDate==null">
                                    <button type="button" class="btn btn-info" style="float:right" ng-click="onstartmeeting(mm)"
                                            data-filterListId="{{mm}}" onclick="loadvalues(this)">
                                        START
                                    </button>
                                </div>
                                <div class="col-sm-12" ng-show="mm.lmslmeeT_MeetingDate !=null">
                                    <button type="button" class="btn btn-info" style="float:right" ng-click="onstartmeeting(mm)"
                                            data-filterListId="{{mm}}" onclick="loadvalues(this)">
                                        RE-JOIN
                                    </button>
                                </div>

                            </div>

                        </div>
                        <dir-pagination-controls max-size="5"
                                                 direction-links="true"
                                                 boundary-links="true">
                        </dir-pagination-controls>
                    </div>
                    <!--<div class="well" ng-repeat="mm in meetinglist">-->

                </div>

                <div class="col-sm-6" ng-show="joinmeetinglist.length>0" style="padding-left:20px">

                    <div class="row">
                        <h4 class="box-title"> UPCOMING MEETINGS</h4>
                    </div>
                    <div class="row">


                        <div class="col-sm-6 pull-right">
                            <div class="form-group">
                                <div class="input-group">
                                    <span class="input-group-addon">
                                        <i class="fa fa-search"></i>
                                    </span>
                                    <input class="form-control" ng-model="searchValue" type="text" placeholder="search here...">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="well" dir-paginate="mm in filterValue3 = (joinmeetinglist | filter : searchValue1)  |itemsPerPage:itemsPerPage1" current-page="currentPage1" ng-class-odd="'odd'">
                            <div class="row">
                                <label class="control-label col-sm-12"> <b>MEETING ID :</b><span style="color:red">{{mm.lmslmeeT_MeetingId}}</span></label>
                                <label class="control-label col-sm-12"> <b>TOPIC:</b><span style="color:forestgreen;font-size:12px;">{{mm.lmslmeeT_MeetingTopic}}</span></label>
                                <label class="control-label col-sm-12"> <b>SCHEDULED BY:</b><span style="color:firebrick;font-size:12px;">{{mm.hrmE_EmployeeFirstName}}</span></label>
                                <label class="control-label col-sm-12"> <b>SCHEDULED DATE/TIME:</b>{{mm.lmslmeeT_PlannedDate |date:'dd/MM/yyyy'}}/({{mm.lmslmeeT_PlannedStartTime}} TO {{mm.lmslmeeT_PlannedEndTime}})</label>
                                <label class="control-label col-sm-12"> <b>START DATE/TIME:</b>{{mm.lmslmeeT_MeetingDate |date:'dd/MM/yyyy'}}/({{mm.lmslmeeT_StartedTime}})</label>
                                <div class="col-sm-12" ng-show="mm.lmslmeeT_MeetingDate==null">
                                    <button type="button" class="btn btn-info" style="float:right">NOT STARTED</button>
                                </div>
                                <div class="col-sm-12" ng-show="mm.lmslmeeT_MeetingDate !=null && (mm.lmslmeeT_EndTime !=null || mm.lmslmeeT_EndTime !='')">
                                    <button type="button" class="btn btn-info" style="float:right" ng-click="joinmeeting(mm)" data-filterListId="{{mm}}" onclick="loadvalues(this)">JOIN</button>
                                </div>

                            </div>

                        </div>
                        <dir-pagination-controls max-size="5"
                                                 direction-links="true"
                                                 boundary-links="true">
                        </dir-pagination-controls>
                    </div>
                    <!--<div class="well" ng-repeat="mm in meetinglist">-->

                </div>

            </div>



        </div>


        <div class="col-sm-12" style="padding:5px" ng-show="meetingst">

            <label class="col-sm-8">
                <b>MEETING TOPIC:</b>  <span style="color:red;font-size:20px;font-weight:bold">{{topic}}</span>
            </label>
            <button type="button" style="background-color:#2669bc;border-radius:20px;" ng-click="clearallsettings()" class="btn btn-info" title="Reset Settings"><i class="fa fa-refresh" aria-hidden="true">&nbsp;&nbsp;Refresh</i></button>
            <button type="button" class="btn btn-warning" style="float:right" ng-click="stopstreeming(meetid);" value="{{meetid}}">
                END MEETING
            </button>
        </div>


        <input hidden type="text" name="hostname" value={{hostname}} ng-model="hostname" id="hostname" />
        <input hidden type="text" name="roomName" value={{roomName}} ng-model="roomName" id="roomName" />
        <!--<button onclick="loadvalues()"></button>-->
        <!--<div class="text-center">
            <h3>Vaps Video Conference Meeting</h3>
            <md-button type="button" class="md-raised md-primary" ng-click="checkmultiple()" onclick="loadvalues()" ng-disabled="startbutton==false">
                <i class="fa fa-window" aria-hidden="true"></i>
                Start Metting
            </md-button>
            <md-button type="button" class="md-raised md-primary" ng-click="stopmeeting()" ng-disabled="startbutton==true">
                <i class="fa fa-close" aria-hidden="true"></i>
                Stop Metting
            </md-button>
        </div>-->
        <div id="meet" style="height:500px;width:100%;">
        </div>
        <br />





    </form>

    <div id="myModal" class="modal fade" role="dialog">
        <div class="modal-dialog" style="width:50%;">
            <div class="modal-content">
                <div class="modal-body">
                    <div class="box">
                        <div class="box-body">
                            <img id="preview" class="img-responsive" />
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <div class="text-center">
                        <button class="btn" ng-click="zoomin()"><i class="fa fa-plus text-black"></i></button>
                        <button class="btn" ng-click="zoomout()"><i class="fa fa-minus text-black"></i></button>

                    </div>
                    <md-button type="button" class="md-raised md-warn" data-dismiss="modal">
                        <i class="fa fa-times" aria-hidden="true"></i>
                        Close
                    </md-button>
                </div>
            </div>
        </div>
    </div>
</section>