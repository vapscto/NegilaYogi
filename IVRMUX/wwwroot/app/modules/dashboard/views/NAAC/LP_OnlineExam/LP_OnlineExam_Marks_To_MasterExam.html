<section class="content" data-ng-init="loaddata()">
    <form class="form-horizontal ng-pristine ng-valid" role="form" name="myForm" data-ng-submit="savedata(objmaster)">
        <div class="box box-primary">
            <div class="box-header with-border">
                <h3 class="box-title"> Students Marks Entry Online Exam </h3>
                <div class="box-tools pull-right">
                    <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                </div>
            </div>
            <div class="box-body">
                <div class="row">
                    <div class="col-sm-12">
                        <div class="col-sm-6">
                            <div class="form-group">
                                <label class="control-label col-sm-4">Academic Year:<strong style="color:red;">*</strong></label>
                                <div class="col-sm-8">
                                    <select class="form-control" id="sel1" name="yrname" ng-model="ASMAY_Id" ng-change="onchangeyear()" required>
                                        <option value="">--Select Academic Year--</option>
                                        <option ng-repeat="option in getyearlist" value="{{option.asmaY_Id}}"
                                                ng-selected="{{option.asmaY_Id == ASMAY_Id}}">
                                            {{option.asmaY_Year}}
                                        </option>
                                    </select>
                                    <div class="error-messages text-center" ng-if="interacted(myForm.yrname)" ng-messages="myForm.yrname.$error">
                                        <div ng-message="required">Select Academic Year</div>
                                    </div>
                                </div>
                            </div>                            
                        </div>

                        <div class="col-sm-6">
                            <div class="form-group">
                                <label class="control-label col-sm-4">Class:<strong style="color:red;">*</strong></label>
                                <div class="col-sm-8">
                                    <select class="form-control" id="sel2" name="clsname" ng-model="ASMCL_Id" ng-change="onchangeclass()" required>
                                        <option value="">--Select Class--</option>
                                        <option ng-repeat="option in getclasslist" value="{{option.asmcL_Id}}"
                                                ng-selected="{{option.asmcL_Id == ASMCL_Id}}">
                                            {{option.asmcL_ClassName}}
                                        </option>
                                    </select>
                                    <div class="error-messages text-center" ng-if="interacted(myForm.clsname)" ng-messages="myForm.clsname.$error">
                                        <div ng-message="required">Select Class</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6">
                            <div class="form-group">
                                <label class="control-label col-sm-4">Section :<strong style="color:red;">*</strong></label>
                                <div class="col-sm-8">
                                    <select class="form-control" id="sel3" name="secname" ng-model="ASMS_Id" ng-change="OnchangeSection()" required>
                                        <option value="">--Select Section--</option>
                                        <option ng-repeat="option in getsectionlist" value="{{option.asmS_Id}}"
                                                ng-selected="{{option.asmS_Id == ASMS_Id}}">
                                            {{option.asmC_SectionName}}
                                        </option>
                                    </select>
                                    <div class="error-messages text-center" ng-if="interacted(myForm.secname)" ng-messages="myForm.secname.$error">
                                        <div ng-message="required">Select Section </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6">
                            <div class="form-group">
                                <label class="control-label col-sm-4">Subject :<strong style="color:red;">*</strong></label>
                                <div class="col-sm-8">
                                    <select class="form-control" id="sel3" name="subname" ng-model="ISMS_Id" ng-change="onchangesubject()" required>
                                        <option value="">--Select Subject--</option>
                                        <option ng-repeat="option in getsubjectlist" value="{{option.ismS_Id}}"
                                                ng-selected="{{option.ismS_Id == ISMS_Id}}">
                                            {{option.ismS_SubjectName}}
                                        </option>
                                    </select>
                                    <div class="error-messages text-center" ng-if="interacted(myForm.subname)" ng-messages="myForm.subname.$error">
                                        <div ng-message="required">Select Subject </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6">
                            <div class="form-group">
                                <label class="control-label col-sm-4">Online Exam Name:<strong style="color:red;">*</strong></label>
                                <div class="col-sm-8">
                                    <select class="form-control" id="sel4" name="exname" ng-model="LPMOEEX_Id" ng-change="OnChangeExam()" required>
                                        <option value="">--Select Online Exam Name--</option>
                                        <option ng-repeat="option in getexamlist" value="{{option.lpmoeeX_Id}}"
                                                ng-selected="{{option.lpmoeeX_Id == LPMOEEX_Id}}">
                                            {{option.lpmoeeX_ExamName}}
                                        </option>
                                    </select>
                                    <div class="error-messages text-center" ng-if="interacted(myForm.exname)" ng-messages="myForm.exname.$error">
                                        <div ng-message="required">Select Online Exam Name</div>
                                    </div>
                                </div>
                            </div>
                        </div>                      
                        <div class="col-sm-6">
                            <div class="form-group">
                                <label class="control-label col-sm-4">Master Exam :<strong style="color:red;">*</strong></label>
                                <div class="col-sm-8">
                                    <select class="form-control" id="sel3" name="subexamname" ng-model="EME_Id" required disabled>
                                        <option value="">--Select Master Exam--</option>
                                        <option ng-repeat="option in getmasterexamdetails" value="{{option.emE_Id}}"
                                                ng-selected="{{option.emE_Id == EME_Id}}">
                                            {{option.emE_ExamName}}
                                        </option>
                                    </select>
                                    <div class="error-messages text-center" ng-if="interacted(myForm.subexamname)" ng-messages="myForm.subexamname.$error">
                                        <div ng-message="required">Select Master Exam </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12 text-center">
                        <md-button type="button" class="md-raised md-primary" ng-disabled="form.$invalid" ng-click="GetExam_OE_StudentList()" id="save-btn">
                            <i class="fa fa-search" aria-hidden="true"></i>
                            Get Student List
                        </md-button>
                        <md-button type="button" class="md-raised md-warn" ng-click="cancel()">
                            <i class="fa fa-times" aria-hidden="true"></i>
                            Cancel
                        </md-button>
                    </div>
                </div>
            </div>
        </div>

        <div class="box box-primary" ng-if="studentdetails.length>0">
            <div class="box-header with-border">
                <h3 class="box-title">Student Details </h3>
                <div class="box-tools pull-right">
                    <button type="button" class="btn btn-box-tool" data-widget="collapse" data-placement="bottom" data-toggle="tooltip" title="collapsible"><i class="fa fa-minus"></i></button>
                </div>
            </div>
            <div class="box-body">
                <div class="row" style="overflow:scroll;">
                    <div class="col-sm-12">
                        <table class="table table-hover table-responsive table-bordered" id="tre">
                            <thead>
                                <tr>
                                    <th>
                                        <label>
                                            <input type="checkbox" data-ng-model="all_s" ng-click="toggleAll_S(all_s)">
                                            <span class="lbl padding-8"></span>
                                        </label>
                                    </th>
                                    <th><a href="" ng-click="order('sno')">Sl.No</a></th>
                                    <th><a href="" ng-click="sort('amsT_FirstName')">Student Name</a></th>
                                    <th ng-show="regno"><a href="" ng-click="sort('amsT_RegistrationNo')">Reg.No.</a></th>
                                    <th ng-show="admno"><a href="" ng-click="sort('amsT_AdmNo')">Adm.No.</a></th>
                                    <th ng-show="rollno"><a href="" ng-click="sort('amaY_RollNo')">Roll No.</a></th>
                                    <th>{{subjectnames}}-(LP_OE_Marks-{{LPMOEEX_TotalMarks}})-(ME-{{marksentryfor}})</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr ng-repeat="datum in studentdetails | orderBy:sortKey:sortReverse">
                                    <td class="text-center">
                                        <label>
                                            <input type="checkbox" ng-model="datum.selected_s" ng-change="optionToggled_S(datum)" ng-disabled="datum.flag=='OE'">
                                            <span class="lbl padding-8"></span>
                                        </label>
                                    </td>
                                    <td class="text-center">{{$index+1}}</td>
                                    <td class="text-left">{{datum.amsT_FirstName}}</td>
                                    <td class="text-left" ng-show="regno"> {{datum.amsT_RegistrationNo}} </td>
                                    <td class="text-left" ng-show="admno"> {{datum.amsT_AdmNo}} </td>
                                    <td class="text-left" ng-show="rollno"> {{datum.amaY_RollNo}} </td>
                                    <td class="text-center">
                                        <input class="form-control" type="text" id="{{$index}}" placeholder="{{placeholder}}"
                                               data-ng-model="datum.ESTM_Marks" value="" name="t1_{{datum.amsT_Id}}"
                                               ng-blur="valid_marks_S(datum)"
                                               ng-paste="$event.preventDefault()" ng-disabled="datum.flag=='OE'" ng-required="datum.selected_s"
                                               allow-pattern="{{allowpattern}}" ng-pattern="ngpattern" />
                                        <div class="error-messages" ng-if="interacted(myForm['t1_'+datum.amsT_Id])" ng-messages="myForm['t1_'+datum.amsT_Id].$error">
                                            <div ng-message="pattern">Enter valid Format[For Example 100.00,99.97,......]</div>
                                            <div ng-message="required" ng-if="marksorgrade_entryflag=='M'">Enter Obtained Marks</div>
                                            <div ng-message="required" ng-if="marksorgrade_entryflag=='G'">Enter Obtained Grade</div>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                </div>
                <hr />
                <div class="row text-center">
                    <md-button type="button" class="md-raised md-primary" id="save-btn"
                               ng-click="SaveOE_Marks_ME()">
                        <!--ng-if="userPrivileges.ivrmirP_AddFlag===true && update==0"-->
                        <i class="fa fa-floppy-o" aria-hidden="true"></i>
                        Save
                    </md-button>

                    <!--<md-button type="button" class="md-raised md-primary"
                               ng-click="SaveOE_Marks_ME()" ng-if="userPrivileges.ivrmirP_UpdateFlag===true && update > 0">
                        <i class="fa fa-refresh" aria-hidden="true"></i>Update
                    </md-button>-->
                    <md-button type="button" class="md-raised md-warn" ng-click="clear()">
                        <i class="fa fa-times" aria-hidden="true"></i>
                        Cancel
                    </md-button>
                </div>
            </div>
        </div>
    </form>    
</section>
