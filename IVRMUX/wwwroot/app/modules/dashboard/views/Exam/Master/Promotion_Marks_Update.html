<section class="content">
    <form class="form-horizontal ng-pristine ng-valid" name="myForm" role="form" novalidate>
        <div data-ng-init="BindData()">
            <div class="box box-primary">
                <div class="box-header with-border">
                    <h3 class="box-title">Promotion Marks Update</h3>
                    <div class="box-tools pull-right">
                        <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                    </div>
                </div>
                <div class="box-body">
                    <div class="row">

                        <div class="col-sm-6">
                            <div class="form-group">
                                <label class="control-label col-sm-4">Academic Year :<span style="color:Red">*</span></label>
                                <div class="col-sm-8">
                                    <select class="form-control" id="sm" name="yeardd" ng-model="ASMAY_Id" ng-change="get_categories()" required>
                                        <option value="">Select Academic Year</option>
                                        <option ng-repeat="year in year_list" value="{{year.asmaY_Id}}" ng-selected="year.Selected == true">{{year.asmaY_Year}}</option>
                                    </select>
                                    <div class="error-messages" ng-if="interacted(myForm.yeardd)" ng-messages="myForm.yeardd.$error">
                                        <div ng-message="required">Please Select Academic Year</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6">
                            <div class="form-group">
                                <label class="control-label col-sm-4">Category :<span style="color:Red">*</span></label>
                                <div class="col-sm-8">
                                    <select class="form-control" name="categ" id="sel1" ng-model="EMCA_Id" required ng-change="get_classes()">
                                        <option value="">Select Category</option>
                                        <option ng-repeat="cat in category_list" value="{{cat.emcA_Id}}" ng-selected="{{cat.Selected == true}}">
                                            {{cat.emcA_CategoryName}}
                                        </option>
                                    </select>
                                </div>
                                <div class="col-sm-8 col-sm-offset-4 error-messages" ng-if="interacted(myForm.categ)" ng-messages="myForm.categ.$error">
                                    <div ng-message="required">Please Select Category</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-6">
                            <div class="form-group">
                                <label class="control-label col-sm-4">Class :<span style="color:Red">*</span></label>
                                <div class="col-sm-8">
                                    <select class="form-control" name="clsss" id="sel1" ng-model="ASMCL_Id" ng-change="get_sections()" required>
                                        <option value="">Select Class</option>
                                        <option ng-repeat="cls in class_list" value="{{cls.asmcL_Id}}" ng-selected="{{cls.Selected == true}}">
                                            {{cls.asmcL_ClassName}}
                                        </option>
                                    </select>
                                </div>
                                <div class="col-sm-8 col-sm-offset-4 error-messages" ng-if="interacted(myForm.clsss)" ng-messages="myForm.clsss.$error">
                                    <div ng-message="required">Please Select Class</div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6">
                            <div class="form-group">
                                <label class="control-label col-sm-4">Section :<span style="color:Red">*</span></label>
                                <div class="col-sm-8">
                                    <select class="form-control" id="sm" name="secc" ng-model="ASMS_Id" ng-change="get_subjects()" required>
                                        <option value="">Select Section</option>
                                        <option ng-repeat="sec in section_list" value="{{sec.asmS_Id}}" ng-selected="sec.Selected == true">{{sec.asmC_SectionName}}</option>
                                    </select>
                                    <div class="error-messages" ng-if="interacted(myForm.secc)" ng-messages="myForm.secc.$error">
                                        <div ng-message="required">Please Select Section</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-6">
                            <div class="form-group">
                                <label class="control-label col-sm-4">Subject :<span style="color:Red">*</span></label>
                                <div class="col-sm-8">
                                    <select class="form-control" name="subjjjj" id="sel1" ng-model="ISMS_Id"  required>
                                        <option value="">Select Subject</option>
                                        <option ng-repeat="sub in subject_list" value="{{sub.ismS_Id}}" ng-selected="{{sub.Selected == true}}">
                                            {{sub.ismS_SubjectName}}
                                        </option>
                                    </select>
                                </div>
                                <div class="col-sm-8 col-sm-offset-4 error-messages" ng-if="interacted(myForm.subjjjj)" ng-messages="myForm.subjjjj.$error">
                                    <div ng-message="required">Please Select Subject</div>
                                </div>
                            </div>
                        </div>
                        
                    </div>
                    <div class="">
                        <div class="text-center">
                            <md-button type="button" class="md-raised md-primary" id="save-btn" ng-click="get_prommarks()">
                                <i class="fa fa-search" aria-hidden="true"></i>
                                 Search
                            </md-button>
                            <md-button type="button" class="md-raised md-warn" ng-show="!prom_subj_groups_details.length>0" data-ng-click="clear()">
                                <i class="fa fa-times" aria-hidden="true"></i>
                                Cancel
                            </md-button>
                        </div>
                    </div>
                    <div class="" ng-show="prom_subj_groups_details.length>0 && student_list.length>0">
                        <div class="well">
                            <div class="col-sm-12">
                                <div class="col-sm-4 pull-right">
                                    <div class="form-group">
                                        <div class="input-group">
                                            <input class="form-control" ng-model="search" type="text" placeholder="search here...">
                                            <span class="input-group-addon">
                                                <i class="fa fa-search"></i>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="text-center">
                                <table class="table table-hover table-responsive table-bordered text-center">
                                    <thead>
                                        <tr>
                                            <th>
                                               SL NO
                                            </th>
                                            <th>
                                                <label>
                                                    <label>
                                                        <input type="checkbox" value="" ng-click="toggleAll()" ng-model="all">
                                                        <span class="lbl padding-8"></span>
                                                    </label>

                                                </label>
                                            </th>
                                            <th style="width:150px;">
                                                <a href="" ng-click="sort('amsT_FirstName')">Student List</a>
                                            </th>
                                            <th style="width:75px;">
                                                <a href="" ng-click="sort('amsT_AdmNo')">Adm. No</a>
                                            </th>
                                            <th style="width:60px;">
                                                <a href="" ng-click="sort('amaY_RollNo')">Roll. No</a>
                                            </th>
                                            <th ng-repeat="grp in prom_subj_groups_details">
                                                {{grp.empsG_DisplayName}}  (Max.Marks - {{grp.Group_MaxMarks}})
                                            </th>
                                            <th>
                                               Total  (100%)
                                            </th>
                                            <th>
                                               Reason
                                            </th>
                                        </tr>
                                    </thead>

                                    <tbody>
                                        <tr ng-repeat="stud in student_list |filter:search">
                                            <td>{{$index+1}}</td>
                                            <td>
                                                <label>
                                                    <input type="checkbox" name="adcheckt" value="{{stud.xyz}}" ng-change="optionToggled()" ng-model="stud.xyz">
                                                    <span class="lbl padding-8"></span>
                                                </label>
                                            </td>
                                            <td>
                                                {{stud.amsT_FirstName}}
                                            </td>
                                            <td>
                                                {{stud.amsT_AdmNo}}
                                            </td>
                                            <td>
                                                {{stud.amaY_RollNo}}
                                            </td>
                                            <td ng-repeat="grp in prom_subj_groups_details">
                                                <input class="form-control" type="text" placeholder="Enter Marks..." data-ng-model="stud.Marks[grp.empsG_Id].ObtMarks" value="" name="t1_{{grp.empsG_Id}}_{{stud.amsT_Id}}" ng-blur="valid_marks_G(grp,grp.empsG_Id,stud.Marks,stud.amsT_Id,stud)" ng-paste="$event.preventDefault()" ng-disabled="!stud.xyz" ng-required="stud.xyz" ng-pattern="/^[0-9]{0,4}\.?[0-9]{1,2}?$/" allow-pattern="[0-9.]" />
                                                <div class="error-messages" ng-if="interacted(myForm['t1_'+grp.empsG_Id+'_'+stud.amsT_Id])" ng-messages="myForm['t1_'+grp.empsG_Id+'_'+stud.amsT_Id].$error">
                                                    <div ng-message="pattern">Enter valid Format[For Example 100.00,99.97,......]</div>
                                                    <div ng-message="required">Enter Group Marks</div>
                                                </div>
                                            </td>
                                            <td>
                                                <input class="form-control" type="text" placeholder="Enter Marks..." data-ng-model="stud.ESTMPPS_ObtainedMarks" value="" name="t2_{{stud.amsT_Id}}" ng-blur="valid_mark(stud.ESTMPPS_ObtainedMarks,stud.amsT_Id,stud)" ng-paste="$event.preventDefault()" ng-disabled="!stud.xyz" ng-required="stud.xyz" ng-pattern="/^[0-9]{0,4}\.?[0-9]{1,2}?$/" allow-pattern="[0-9.]"/>
                                                <div class="error-messages" ng-if="interacted(myForm['t2_'+stud.amsT_Id])" ng-messages="myForm['t2_'+stud.amsT_Id].$error">
                                                    <div ng-message="pattern">Enter valid Format[For Example 100.00,99.97,......]</div>
                                                    <div ng-message="required">Enter Total Marks</div>
                                                </div>
                                            </td>
                                            <td>
                                                <input class="form-control" type="text" placeholder="Enter Reason..." data-ng-model="stud.Reason" value="" name="t3_{{stud.amsT_Id}}"  ng-paste="$event.preventDefault()" ng-disabled="!stud.xyz" ng-required="stud.xyz"/>
                                                <div class="error-messages" ng-if="interacted(myForm['t3_'+stud.amsT_Id])" ng-messages="myForm['t3_'+stud.amsT_Id].$error">
                                                    <div ng-message="required">Enter Reason</div>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>                                
                            </div>
                        </div>
                    </div>
                    <hr />
                    <div class="text-center" ng-show="prom_subj_groups_details.length>0 && student_list.length>0">
                        <md-button type="submit" class="md-raised md-primary" data-ng-click="saveddata()">
                            <i class="fa fa-floppy-o" aria-hidden="true"></i>
                            Save
                        </md-button>
                        <md-button type="button" class="md-raised md-warn" data-ng-click="clear()">
                            <i class="fa fa-times" aria-hidden="true"></i>
                            Cancel
                        </md-button>
                    </div>
                </div>
            </div>
        </div>
       
    </form>


</section>