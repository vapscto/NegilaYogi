<section class="content twocoloumn">
    <div class="box box-primary" ng-init="BindData()">
        <div class="box-header with-border">
            <h3 class="box-title">Category Subject Mapping</h3>
            <div class="box-tools pull-right">
                <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
            </div>
        </div>
        <div class="box-body">
            <md-content>
                <md-tabs md-dynamic-height md-border-bottom>
                    <md-tab label="Yearly Category Subject Mapping">
                        <md-content class="md-padding">
                            <form class="form-horizontal ng-pristine ng-valid" name="myForm" role="form" novalidate>
                                <div class="box box-primary">
                                    <div class="box-header with-border">
                                        <h3 class="box-title">Yearly Category Subject Mapping</h3>
                                        <div class="box-tools pull-right">
                                            <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                                        </div>
                                    </div>
                                    <div class="box-body">
                                        <div class="row col-sm-12">
                                            <div class="col-sm-6">
                                                <div class="form-group">
                                                    <label class="control-label col-sm-4">Academic Year :<span style="color:Red">*</span></label>
                                                    <div class="col-sm-8">
                                                        <select class="form-control" id="sel1" name="year" ng-model="ASMAY_Id"
                                                                ng-change="get_category(ASMAY_Id)" required>
                                                            <option value="">--Select--</option>
                                                            <option ng-repeat="option in year_list" value="{{option.asmaY_Id}}"
                                                                    ng-selected="{{option.Selected == true}}">
                                                                {{option.asmaY_Year}}
                                                            </option>
                                                        </select>
                                                    </div>
                                                    <div class="col-sm-8 col-sm-offset-4 error-messages" ng-if="interacted(myForm.year)"
                                                         ng-messages="myForm.year.$error">
                                                        <div ng-message="required">Select Academic Year</div>
                                                    </div>
                                                </div>

                                                <div class="form-group">
                                                    <label class="control-label col-sm-4">Category :<span style="color:Red">*</span></label>
                                                    <div class="col-sm-8">
                                                        <select class="form-control" id="sel1" name="categy" ng-model="EMCA_Id" ng-change="valid_cat()" required>
                                                            <option value="">--Select--</option>
                                                            <option ng-repeat="option in category_list" value="{{option.emcA_Id}}"
                                                                    ng-selected="{{option.Selected == true}}">
                                                                {{option.emcA_CategoryName}}
                                                            </option>
                                                        </select>
                                                    </div>
                                                    <div class="col-sm-8 col-sm-offset-4 error-messages" ng-if="interacted(myForm.categy)"
                                                         ng-messages="myForm.categy.$error">
                                                        <div ng-message="required">Select Category</div>
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label class="control-label col-sm-4">Subject Group :<span style="color:Red">*</span></label>
                                                    <div class="col-sm-8">
                                                        <select class="form-control" id="sel1" name="group" ng-model="EMG_Id" ng-change="get_subjects(EMG_Id)" required>
                                                            <option value="">--Select--</option>
                                                            <option ng-repeat="option in group_list" value="{{option.emG_Id}}"
                                                                    ng-selected="{{option.Selected == true}}">
                                                                {{option.emG_GroupName}}
                                                            </option>
                                                        </select>
                                                    </div>
                                                    <div class="col-sm-8 col-sm-offset-4 error-messages" ng-if="interacted(myForm.group)"
                                                         ng-messages="myForm.group.$error">
                                                        <div ng-message="required">Select Subject Group</div>
                                                    </div>
                                                </div>

                                                <div class="form-group">
                                                    <label>
                                                        <input type="checkbox" data-ng-model="EYC_BasedOnPaperTypeFlg">
                                                        <span class="lbl padding-8"></span> Exam Wise Paper Type Flag
                                                    </label>
                                                </div>
                                            </div>

                                            <div class="col-sm-6">
                                                <div class="form-group">
                                                    <label for="sel2" class="control-label col-sm-4">Subjects : <span style="color:Red">*</span></label>
                                                    <div class="col-sm-8">
                                                        <div class="multiselect col-sm-8">
                                                            <label>
                                                                <input name="classes" value="usercheck" ng-model="usercheck" type="checkbox"
                                                                       data-ng-click="all_check(usercheck)">
                                                                <span class="lbl padding-8">
                                                                    All
                                                                </span>
                                                            </label>
                                                            <label data-ng-model="PASR_Id" name="subjs1" ng-repeat="StuName in subject_list | filter:filterValue" value="{{StuName.ismS_Id}}">
                                                                <input name="subjs" value="1" ng-model="StuName.checked" type="checkbox" ng-click="togchkbx();" ng-required="isOptionsRequired()">
                                                                <span class="lbl padding-8">
                                                                    {{StuName.ismS_SubjectName}}
                                                                </span>
                                                            </label>
                                                        </div>
                                                        <div class="error-messages" ng-if="interacted(myForm.subjs)" ng-messages="myForm.subjs.$error">
                                                            <div ng-message="required">Select Atleast One checkbox</div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <hr />
                                        <div class="text-center">
                                            <input type="hidden" value="{{EYC_Id}}" ng-model="EYC_Id" />
                                            <input type="hidden" value="{{EYCG_Id}}" ng-model="EYCG_Id" />
                                            <input type="hidden" value="{{EYCGS_Id}}" ng-model="EYCGS_Id" />
                                            <md-button type="submit" class="md-raised md-primary" id="save-btn" ng-click="savedata()">
                                                <i class="fa fa-floppy-o" aria-hidden="true"></i>
                                                save
                                            </md-button>
                                            <md-button type="submit" class="md-raised md-warn" ng-click="clear()">
                                                <i class="fa fa-times" aria-hidden="true"></i>
                                                Cancel
                                            </md-button>
                                        </div>
                                    </div>
                                </div>
                            </form>
                            <div class="box box-primary">
                                <div class="box-header with-border">
                                    <h3 class="box-title">Grid View</h3>
                                    <div class="box-tools pull-right">
                                        <button type="button" class="btn btn-box-tool" data-widget="collapse" data-placement="bottom" data-toggle="tooltip" title="collapsible"><i class="fa fa-minus"></i></button>
                                    </div>
                                </div>
                                <!-- /.box-header -->
                                <div class="box-body">
                                    <div ui-grid="gridOptions" ui-grid-pagination class="grid text-center" id="style-4" style="height: 270px;"></div><!--ui-grid-edit-->
                                </div>
                            </div>
                        </md-content>
                    </md-tab>
                    <md-tab label="Yearly Category Dates Mapping" ng-click="OnLoadCategoryDates()">
                        <md-content class="md-padding">
                            <form class="form-horizontal ng-pristine ng-valid" name="myForm1" role="form" novalidate>
                                <div class="box box-primary">
                                    <div class="box-header with-border">
                                        <h3 class="box-title">Yearly Category Dates Mapping</h3>
                                        <div class="box-tools pull-right">
                                            <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                                        </div>
                                    </div>
                                    <div class="box-body">
                                        <div class="row">
                                            <div class="col-sm-12">
                                                <div class="col-sm-6">
                                                    <div class="form-group">
                                                        <label class="control-label col-sm-4">Academic Year :<span style="color:Red">*</span></label>
                                                        <div class="col-sm-8">
                                                            <select class="form-control" id="sel1" name="year" ng-model="ASMAY_Id" 
                                                                    ng-change="get_categoryDates(ASMAY_Id)" required>
                                                                <option value="">--Select--</option>
                                                                <option ng-repeat="option in yearlist_new" value="{{option.asmaY_Id}}" 
                                                                        ng-selected="{{option.Selected == true}}">
                                                                    {{option.asmaY_Year}}
                                                                </option>
                                                            </select>
                                                        </div>
                                                        <div class="col-sm-8 col-sm-offset-4 error-messages" ng-if="interacted1(myForm1.year)" 
                                                             ng-messages="myForm1.year.$error">
                                                            <div ng-message="required">Please Select Academic Year</div>
                                                        </div>
                                                    </div>                                                    
                                                </div>
                                                <div class="col-sm-6">
                                                    <div class="form-group">
                                                        <label class="control-label col-sm-4">Category :<span style="color:Red">*</span></label>
                                                        <div class="col-sm-8">
                                                            <select class="form-control" id="sel1" name="categy" ng-model="EMCA_Id" required>
                                                                <option value="">--Select--</option>
                                                                <option ng-repeat="option in category_list_new" value="{{option.emcA_Id}}" 
                                                                        ng-selected="{{option.Selected == true}}">
                                                                    {{option.emcA_CategoryName}}
                                                                </option>
                                                            </select>
                                                        </div>
                                                        <div class="col-sm-8 col-sm-offset-4 error-messages" ng-if="interacted1(myForm1.categy)" 
                                                             ng-messages="myForm1.categy.$error">
                                                            <div ng-message="required">Please Select Category</div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-6">
                                                <div class="form-group">
                                                    <label class="control-label col-sm-4">Exam Start Date:</label>
                                                    <div class="col-sm-8" style="padding-left:0px;">
                                                        <md-datepicker name="sbsdt" ng-model="EYC_ExamStartDate" md-placeholder="Select date..."
                                                                 required md-min-date="mindate" ng-change="nextdate()" md-max-date="maxdate"></md-datepicker>
                                                        <div class="error-messages" ng-if="interacted1(myForm1.sbsdt)" ng-messages="myForm1.sbsdt.$error">
                                                            <div ng-message="required">Select Exam Start Date</div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-6">
                                                <div class="form-group">
                                                    <label class="control-label col-sm-4">Exam End Date:</label>
                                                    <div class="col-sm-8" style="padding-left:0px;">
                                                        <md-datepicker name="startdate" ng-model="EYC_ExamEndDate" md-placeholder="Select Date"
                                                                   required md-min-date="EYC_ExamStartDate" ng-change="enddatechange()" md-max-date="maxdate">
                                                        </md-datepicker>
                                                        <div class="error-messages" ng-if="interacted1(myForm1.startdate)" ng-messages="myForm1.startdate.$error">
                                                            <div ng-message="required">Select ExamEndDate</div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-6">
                                                <div class="form-group">
                                                    <label class="control-label col-sm-4">Marks Entry LastDate:</label>
                                                    <div class="col-sm-8" style="padding-left:0px;">
                                                        <md-datepicker name="markentrylastdate" ng-model="EYC_MarksEntryLastDate" md-placeholder="Select Date"
                                                                       required md-min-date="EYC_ExamEndDate" ng-change="markentrychange()" md-max-date="maxdate">
                                                        </md-datepicker>
                                                        <div class="error-messages" ng-if="interacted1(myForm1.markentrylastdate)"
                                                             ng-messages="myForm1.markentrylastdate.$error">
                                                            <div ng-message="required">Select Marks Entry LastDate</div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-6">
                                                <div class="form-group">
                                                    <label class="control-label col-sm-4">Marks Process LastDate:</label>
                                                    <div class="col-sm-8" style="padding-left:0px;">
                                                        <md-datepicker name="EYC_MarksProcessLastDate" ng-model="EYC_MarksProcessLastDate"
                                                                       required md-placeholder="Select Date" md-min-date="EYC_MarksEntryLastDate" md-max-date="maxdate" 
                                                                       ng-change="markprocesschange()">
                                                        </md-datepicker>
                                                        <div class="error-messages" ng-if="interacted1(myForm1.EYC_MarksProcessLastDate)"
                                                             ng-messages="myForm1.EYC_MarksProcessLastDate.$error">
                                                            <div ng-message="required">Select Marks Process LastDate</div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-6">
                                                <div class="form-group">
                                                    <label class="control-label col-sm-4">Marks PublishDate:</label>
                                                    <div class="col-sm-8" style="padding-left:0px;">
                                                        <md-datepicker name="EYC_MarksPublishDate" ng-model="EYC_MarksPublishDate" md-placeholder="Select Date"
                                                                       required md-min-date="EYC_MarksProcessLastDate" md-max-date="maxdate"  
                                                                       ng-change="markpublishchange()">
                                                        </md-datepicker>
                                                        <div class="error-messages" ng-if="interacted1(myForm1.EYC_MarksPublishDate)"
                                                             ng-messages="myForm1.EYC_MarksPublishDate.$error">
                                                            <div ng-message="required">Select EYC_MarksPublishDate</div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-6">
                                                <div class="text-center">
                                                    <md-button type="submit" class="md-raised md-primary" id="save-btn" ng-click="savedatadates()">
                                                        <i class="fa fa-floppy-o" aria-hidden="true"></i>
                                                        save
                                                    </md-button>
                                                    <md-button type="submit" class="md-raised md-warn" ng-click="cleardates()">
                                                        <i class="fa fa-times" aria-hidden="true"></i>
                                                        Cancel
                                                    </md-button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </form>
                            <div class="box box-primary">
                                <div class="box-header with-border">
                                    <h3 class="box-title">Yearly Category Dates Mapping Details</h3>
                                    <div class="box-tools pull-right">
                                        <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                                    </div>
                                </div>
                                <div class="box-body">
                                    <div class="row">
                                        <div class="col-sm-12">
                                            <div class="col-sm-4 pull-right">
                                                <input class="form-control" ng-model="search" type="text" placeholder="search here...">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-12">
                                            <table class="table table-bordered">
                                                <thead>
                                                    <tr>
                                                        <th>Sl.No</th>
                                                        <th>Year</th>
                                                        <th>Category</th>
                                                        <th>Start Date</th>
                                                        <th>End Date</th>
                                                        <th>Marks Entry Last Date</th>
                                                        <th>Marks Process Last Date</th>
                                                        <th>Marks Publish Date</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr dir-paginate="user in filterValue1=(getdetails |filter:search) |orderBy:sortKey:sortReverse  |itemsPerPage:itemsPerPage1" current-page="currentPage1">
                                                        <td class="text-center">{{itemsPerPage1 *(currentPage1-1)+$index+1}}</td>
                                                        <td class="text-left">{{user.asmaY_Year}}</td>
                                                        <td class="text-left">{{user.emcA_CategoryName}}</td>
                                                        <td class="text-left">{{user.eyC_ExamStartDate | date:'dd/MM/yyyy'}}</td>
                                                        <td class="text-left">{{user.eyC_ExamEndDate | date:'dd/MM/yyyy'}}</td>
                                                        <td class="text-left">{{user.eyC_MarksEntryLastDate | date:'dd/MM/yyyy'}}</td>
                                                        <td class="text-left">{{user.eyC_MarksProcessLastDate | date:'dd/MM/yyyy'}}</td>
                                                        <td class="text-left">{{user.eyC_MarksPublishDate | date:'dd/MM/yyyy'}}</td>
                                                    </tr>
                                                </tbody>
                                            </table>

                                            <dir-pagination-controls max-size="5"
                                                                     direction-links="true"
                                                                     boundary-links="true">
                                            </dir-pagination-controls>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </md-content>
                    </md-tab>
                </md-tabs>
            </md-content>
        </div>
    </div>
</section>

<div class="modal fade  modal-medium" id="popup" role="dialog">
    <div class="modal-dialog modal-md">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal"><i class="fa fa-times text-white" aria-hidden="true"></i></button>
            <h4 class="modal-title text-white">"{{Category_Name}}-{{Group_Name}}" Mapped Subjects</h4>
        </div>
        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-body">
                <table class="table table-hover table-responsive table-bordered">
                    <thead>
                        <tr>
                            <th><a href="" ng-click="sort('emgS_Id')">SLNO</a></th>
                            <th><a href="" ng-click="sort('ismS_SubjectName')">Subject Name</a></th>
                            <th><a href="" ng-click="sort('ismS_SubjectCode')">Subject Code</a></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="user in viewrecordspopupdisplay" current-page="currentPage">
                            <td class="text-center">{{itemsPerPage *(currentPage-1)+$index+1}}</td>
                            <td class="text-left">{{ user.ismS_SubjectName}}</td>
                            <td class="text-left">{{ user.ismS_SubjectCode}}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" ng-click="clearpopupgrid()" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>