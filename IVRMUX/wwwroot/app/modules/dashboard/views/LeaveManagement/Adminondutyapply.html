<section class="content">
    <div data-ng-init="loadData()">
        <form class="form-horizontal ng-pristine ng-valid" role="form" name="myFormextra" novalidate>
            <div class="box box-primary">
                <div class="box-header with-border">
                    <h3 class="box-title">Admin Onduty Apply</h3>
                    <div class="box-tools pull-right">
                        <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                    </div>

                </div>
                <br />
                <br />


                <div class="form-group">
                    <label class="control-label col-sm-offset-4">Employee  Name</label>
                    <div class="col-sm-offset-4">
                        <ui-select id="sel1" name="empname" ng-model="obj.hrmE_Id" ng-true-value="1" theme="bootstrap" ng-keyup="searchfilter($select,filterdata);" ng-change="employeedetails(hrmE_Id)" style="width:40%" title="Select Employee" required>
                            <ui-select-match placeholder="Select or search Employee in the list...">
                                {{$select.selected.hrmE_EmployeeFirstName}} {{$select.selected.hrmE_EmployeeMiddleName}}
                                {{$select.selected.hrmE_EmployeeLastName}}
                            </ui-select-match>
                            <ui-select-choices repeat="option in employeename | propsFilter: {hrmE_EmployeeFirstName: $select.search}" value="{{option.hrmE_Id}}" ng-selected="{{option.Selected == true}}" >
                                <div ng-bind-html="option.hrmE_EmployeeFirstName + ' ' + option.hrmE_EmployeeMiddleName + ' ' + option.hrmE_EmployeeLastName + '--' + option.hrmE_EmployeeCode | highlight: $select.search"></div>
                            </ui-select-choices>
                        </ui-select>
                    </div>
                    <div class="error-messages" ng-if="interacted(myForm.empname)" ng-messages="myForm.empname.$error">
                        <div ng-message="required" style="margin-left:270px;"> Select Employee First</div>
                    </div>
                </div>


                <!-- /.box-header -->
                <div class="box-body">

                    <div class="box-body">
                        <div class="row" ng-if="EmployeeDeatils.length > 0 ">
                            <div class="col-sm-3">
                               
                                    <div class="d-flex flex-column align-items-center text-center">
                                        <img src="" ng-src="{{hrme_photo}}" class="rounded-circle" width="125" height="160">

                                    </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label class="control-label col-sm-4">Employee Name</label>
                                    <div class="col-sm-4">
                                        <label class="control-label">
                                            :
                                            {{hrme_employeefirstname}}
                                        </label>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="control-label col-sm-4">DOJ</label>
                                    <div class="col-sm-8">
                                        <label class="control-label">: {{hrmE_DOJ | date:'dd-MM-yyyy'}}</label>
                                    </div>
                                </div>

                            </div>
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label class="control-label col-sm-4">Designation</label>
                                    <div class="col-sm-8">
                                        <label class="control-label">: {{hrmdeS_DesignationName}}</label>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="control-label col-sm-4">Email</label>
                                    <div class="col-sm-8">
                                        <label class="control-label">: {{hrmE_EmailId}}</label>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="control-label col-sm-4">Phone</label>
                                    <div class="col-sm-8">
                                        <!--<input type="text" class="form-control" name="">-->
                                        <label class="control-label">: {{hrmE_MobileNo}}</label>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>

                </div>
            </div>

            <div class="box box-primary">
                <div class="box-header with-border">
                    <h3 class="box-title">REQUEST - ON DUTY / COMP OFF</h3>
                    <div class="box-tools pull-right">
                        <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                    </div>
                </div>

                <!-- /.box-header -->
                <div class="box-body">
                    <div class="row">
                        <div class="modal-body">
                            <div class="row">
                                <div class="col-sm-12 text-center">
                                    <div class="well">
                                        <label class="control-label" ng-init="leavetype='OD'">
                                            <input type="radio" name="vf21" value="OD" ng-model="leavetype">
                                            <span class="lbl padding-8">ON DUTY</span>
                                        </label>
                                        <!--<label class="control-label">
                                            <input type="radio" name="vf211" value="COMPOFF" ng-model="leavetype">
                                            <span class="lbl padding-8">COMP OFF</span>
                                        </label>-->
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <label class="control-label col-sm-5">Worked On :<strong style="color:red;display:inline; font-weight: bolder; margin-left: 7px;">*</strong></label>
                                        <div class="col-sm-6 input-group text-right" style="">
                                            <md-datepicker ng-model="fromDate" onkeydown="return false" name="applydate" id="date2" md-placeholder="Worked Date" required></md-datepicker>
                                            <div class="error-messages" ng-if="interacted2(myFormextra.applydate)" ng-messages="myFormextra.applydate.$error">
                                                <div ng-message="required">Please Select Worked Date</div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="control-label col-sm-5" style="padding-top:7%;">Work Start Time : <strong style="color:red;">*</strong></label>
                                        <div class="col-sm-7">
                                            <div uib-timepicker name="sch_time1" ng-model="hrelapD_InTime" ng-change="validateTomintime(hrelapD_InTime)" hour-step="hstep" minute-step="mstep" ng-disabled="timedis" show-meridian="ismeridian" required></div>
                                            <div class="error-messages" ng-if="interacted2(myFormextra.sch_time1)" ng-messages="myFormextra.sch_time1.$error">
                                                <div ng-message="required">Select Work Start Time</div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="control-label col-sm-5" style="padding-top:7%;">Work End Time : <strong style="color:red;">*</strong></label>
                                        <div class="col-sm-7">
                                            <div uib-timepicker name="sch_time2" ng-model="hrelapD_OutTime" min="min" ng-change="validatemax(hrelapD_OutTime)" hour-step="hstep" minute-step="mstep" ng-disabled="timedis" show-meridian="ismeridian" required></div>
                                            <div class="error-messages" ng-if="interacted2(myFormextra.sch_time2)" ng-messages="myFormextra.sch_time2.$error">
                                                <div ng-message="required">Select Work End Time</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <label class="control-label col-sm-4">Reason : <span style="color:Red">*</span></label>
                                        <div class="col-sm-8">
                                            <textarea class="form-control" rows="5" id="reasons" data-ng-model="HRELAP_LeaveReason" name="details" ng-paste="$event.preventDefault()" required style="resize: none"></textarea>
                                            <div class="error-messages " ng-if="interacted2(myFormextra.details)" ng-messages="myFormextra.details.$error">
                                                <div ng-message="required">Enter Reason</div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="control-label col-sm-4">Attach File :</label>
                                        <div class="col-sm-8">
                                            <label class="student-photoadm custom-file-input" style="width:60%;margin:auto;text-align:center">
                                                <input id="documentid2" type="file" name="doc" accept="image/*" data-ng-model="hrme" onchange="angular.element(this).scope().selectFileforUploadzdBOSBOE(this)">
                                            </label>
                                            <div class="error-messages" ng-if="interacted2(myFormextra.doc)" ng-messages="myFormextra.doc.$error">
                                                <div ng-message="required">Please upload the file</div>
                                            </div>
                                            <span ng-if="hrelT_SupportingDocument !=null && hrelT_SupportingDocument !=''">
                                                <a ng-if="extention=='jpg' || extention=='JPG' || extention=='jpeg'|| extention=='png' ||  extention=='JPEG'" style="color:red;display:inline; font-weight: bolder;" data-toggle="modal" data-ng-click="showmodaldetailsBOSBOE()"> view</a>
                                                <a ng-if="extention=='pdf'" style="color:red;display:inline; font-weight: bolder;" data-toggle="modal" data-target="#showpdf" data-ng-click="showmodaldetailsBOSBOE()"> view</a>
                                            </span>
                                        </div>
                                    </div>

                                    <div class="form-group" style="margin-top:10% !important">
                                        <p class="text-red"><b>Note : File Size Not More Then 2MB</b></p>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-sm-6 col-sm-offset-3 text-center">

                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="text-center">
                        <md-button type="submit" ng-disabled="myFormextra.$ivalid" class="md-raised md-primary" ng-click="CompOffODRequest()">
                            <i class="fa fa-tags" aria-hidden="true"></i> Apply
                        </md-button>
                        <md-button type="button" class="md-raised md-warn" ng-click="cancel()">
                            <i class="fa fa-times" aria-hidden="true"></i> Cancel
                        </md-button>
                    </div>
                </div>
            </div>

            <div class="box box-primary">
                <div class="box-header with-border">
                    <h3 class="box-title">Employee Leave Details</h3>
                    <div class="box-tools pull-right">
                        <button type="button" class="btn btn-box-tool" data-widget="collapse" data-placement="bottom" data-toggle="tooltip" title="collapsible"><i class="fa fa-minus"></i></button>
                    </div>
                </div>
                <div class="box-body">
                    <div class="col-sm-3 pull-right">
                        <div class="form-group">
                            <div class="input-group">
                                <input class="form-control" ng-model="searchValue" type="text" placeholder="search here...">
                                <span class="input-group-addon">
                                    <i class="fa fa-search"></i>
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-12 text-wrap" style="overflow-x:auto">
                        <table class="table table-bordered">
                            <thead>
                                <tr>
                                    <th style="width:10%"><a href="" ng-click="order('sno')">SL.NO.</a></th>
                                    <th style="width:20%"><a href="" ng-click="sort('hrmL_LeaveName')">Employee Name</a></th>
                                    <th style="width:20%"><a href="" ng-click="sort('hrmL_LeaveName')">LEAVE NAME</a></th>
                                    <th style="width:30%"><a href="" ng-click="sort('hrelaP_LeaveReason')">LEAVE REASON</a></th>
                                    <th style="width:15%"><a href="" ng-click="sort('hrelaP_FromDate')">From Date</a></th>
                                    <th style="width:15%"><a href="" ng-click="sort('hrelaP_ToDate')">To Date</a></th>
                                    <th style="width:10%"><a href="" ng-click="sort('hreltD_TotDays')">NO. OF DAYS</a></th>
                                    <th style="width:10%"><a href="" ng-click="sort('hrelaP_ApplicationStatus')">STATUS</a></th>
                                    <th style="width:10%"><a href="" ng-click="sort('hrelaP_ApplicationStatus')">VIEW</a></th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr dir-paginate="user in leave_name |itemsPerPage:itemsPerPage2 | filter : searchValue" current-page="currentPage2" pagination-id="page1">
                                    <!--<tr dir-paginate="user in leave_name |orderBy:sortKey:reverse |itemsPerPage:itemsPerPage2" current-page="currentPage2" pagination-id="page1">-->
                                    <td class="text-center">{{itemsPerPage2 *(currentPage2-1)+$index+1}}</td>

                                    <td class="text-left">
                                        {{user.HRME_EmployeeFirstName}}
                                    </td>
                                    <td class="text-left" ng-if="user.hrelapD_InTime.length>0 && user.hrelapD_OutTime.length>0 && user.hrmL_LeaveCode=='COMPOFF'">
                                        Comp Off Request
                                    </td>
                                    <td class="text-left" ng-if="user.hrelapD_InTime.length>0 && user.hrelapD_OutTime.length>0 && user.hrmL_LeaveCode=='OD'">
                                        On Duty Request
                                    </td>

                                    <td class="text-left" ng-if="user.hrelapD_InTime.length==null && user.hrelapD_OutTime.length==null">
                                        {{user.hrmL_LeaveName}}
                                    </td>
                                    <td class="text-left" style="word-wrap:break-word">
                                        <table ng-if="user.hrelapD_InTime.length>0 && user.hrelapD_OutTime.length>0">
                                            <tr><td><b>Worked Time:-{{user.hrelapD_InTime}}&nbsp;To&nbsp;{{user.hrelapD_OutTime}}</b></td></tr>
                                        </table>
                                        {{user.hrelaP_LeaveReason}}
                                    </td>
                                    <td class="text-center">{{user.hrelaP_FromDate | date:'dd/MM/yyyy'}}</td>
                                    <td class="text-center">{{user.hrelaP_ToDate | date:'dd/MM/yyyy'}}</td>
                                    <td class="text-center">{{user.hreltD_TotDays}}</td>
                                    <td class="text-left" style="word-wrap:break-word">{{user.hrelaP_ApplicationStatus}}</td>
                                    <td class="hidden">{{user.hrmL_LeaveCode}}</td>
                                    <td class="text-center">
                                        <span ng-if="user.hrelaP_ApplicationStatus !='Applied' ">
                                            <a href="javascript:void(0)" ng-model="user.Comments" data-toggle="modal" title="View Comments" data-target="#myModalgetclasslist" ng-click="viewcomment(user)"><i class="fa fa-eye fa-1x" aria-hidden="true"></i></a>
                                        </span>
                                    </td>
                                    <!--<div class="grid-action-cell" ng-if="user.hrelaP_ApplicationStatus !='Applied' && user.hrmL_LeaveCode !='COMPOFF'|| user.hrmL_LeaveCode !='OD' ">
        <a  href="javascript:void(0)" ng-model="user.Comments" data-toggle="modal" title="View Comments" data-target="#CompofforOndutyView" ng-click="viewcomment(user)"><i class="fa fa-eye fa-1x" aria-hidden="true"></i></a>
    </div>-->
                                    <td class="text-center">
                                        <span ng-if="user.hrelaP_ApplicationStatus=='Applied'">
                                            <a href="javascript:void(0)" ng-click="deactive(user)" class="fa fa-trash" data-placement="bottom" data-toggle="tooltip" title="Delete">
                                            </a>
                                        </span>
                                        <a href="javascript:void(0)" ng-click="editDetails(user)" class="text-primary" data-placement="bottom" data-toggle="tooltip" title="Edit">
                                            <i class="fa fa-pencil-square-o" aria-hidden="true"></i>
                                        </a>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <dir-pagination-controls max-size="5" pagination-id="page1"
                                                 direction-links="true"
                                                 boundary-links="true">
                        </dir-pagination-controls>
                    </div>
                </div>
            </div>

            <div id="myModalgetclasslist" class="modal fade" role="dialog" data-backdrop="false">
                <div class="modal-dialog modal-lg" style="width: 80%;">
                    <div class="modal-content">
                        <div class="model-header custom-header">
                            <center><h4 class="modal-title custom">Leave Status</h4></center>
                        </div>
                        <div class="modal-body">
                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="col-sm-6 text-left">
                                        <b> Applied Start Date    {{Applied_Fromdate |date:dd/MM/yyyy}}</b>
                                    </div>
                                    <div class="col-sm-6 text-left">
                                        <b>  Applied End Date    {{Applied_Todate|date:dd/MM/yyyy}}</b>
                                    </div>
                                </div>
                            </div>
                            <div class="row margin-top-10">
                                <div class="col-sm-12">
                                    <div style="overflow:auto">
                                        <table class="table table-bordered">
                                            <thead>
                                                <tr>
                                                    <th>Sl.No.</th>
                                                    <th>Approved By</th>
                                                    <th>Approved Date</th>
                                                    <th>Approved Days</th>
                                                    <th>Approved From Date</th>
                                                    <th>Approved To Date</th>
                                                    <th>Status</th>
                                                    <th>Comment</th>
                                                    <th>Document</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr ng-repeat="cmnt in commentlist">
                                                    <td>{{$index + 1}}</td>
                                                    <td class="text-left">{{cmnt.IVRMSTAUL_UserName	}}</td>
                                                    <td class="text-center">{{cmnt.createdDate | date:'dd/MM/yyyy'}}</td>
                                                    <td class="text-center">{{cmnt.HRELAPA_TotalDays}}</td>
                                                    <td class="text-center">{{cmnt.HRELAPA_FromDate	 | date:'dd/MM/yyyy'}}</td>
                                                    <td class="text-center">{{cmnt.HRELAPA_ToDate	 | date:'dd/MM/yyyy'}}</td>
                                                    <td class="text-left">{{cmnt.HRELAPA_LeaveStatus	}}</td>
                                                    <td class="text-left"> {{cmnt.HRELAPA_Remarks}}</td>
                                                    <td class="text-center">
                                                        <a href="javascript:void(0)" ng-if="Supporting_Document != null" ng-model="cmnt.HRELAP_SupportingDocument" ng-click="viewdocument(cmnt);" title="View Document"> <i class="fa fa-eye text-blue"></i></a><a href="javascript:void(0)" ng-if="Supporting_Document == null" ng-model="cmnt.HRELAP_SupportingDocument" ng- title="No Document"> <i class="fa fa-eye-slash text-red"></i></a>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                    <div class="modal-footer custom-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>

            <div id="showpdf" class="modal fade" role="dialog" data-backdrop="static">
                <div class="modal-dialog modal-lg">
                    <div class="modal-content">
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                        </div>
                        <!--<div id="pdfId"></div>-->
                        <embed id="idpdf" ng-src="{{content}}" onload="refreshDialer();" style="width: 100%;" height="1000" />
                        <div class="modal-body" oncontextmenu="return false"></div>
                    </div>
                </div>
            </div>

            <div id="myModal" class="modal fade" role="dialog">
                <div class="modal-dialog" style="width:50%;">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <div class="modal-body">
                            <div class="box">
                                <!-- /.box-header -->
                                <div class="box-body">
                                    <img id="preview" class="img-responsive" />
                                    <!--ng-init="zoomWidth = 100;imgStyle = {width:'100px'}" ng-style="imgStyle"
                                    ng-mouse-wheel-up="zoomWidth = zoomWidth + 20; imgStyle.width = zoomWidth +'px'; "
                                    ng-mouse-wheel-down="zoomWidth = zoomWidth - 20;imgStyle.width = zoomWidth  +'px'; " />-->
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <div class="text-center">
                                <button class="btn" ng-click="zoomin()"><i class="fa fa-plus text-black"></i></button>
                                <button class="btn" ng-click="zoomout()"><i class="fa fa-minus text-black"></i></button>
                            </div>
                            <md-button type="button" class="md-raised md-warn" data-dismiss="modal">
                                <i class="fa fa-times" aria-hidden="true"></i>
                                Close
                            </md-button>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>
</section>
